"use strict";exports.id=2640,exports.ids=[2640],exports.modules={54348:(e,a,t)=>{t.d(a,{Z:()=>g});var s=t(10326),l=t(17577),r=t(62288),i=t(90772),n=t(54432),d=t(31048),c=t(87673),o=t(33071),m=t(26173),h=t(63685);let p=(0,t(62881).Z)("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);var x=t(94019),u=t(41291),y=t(32933),j=t(34789);function g({isOpen:e,onClose:a,requestId:t,requestTitle:g,onUploadComplete:v}){let[N,f]=(0,l.useState)([]),[b,k]=(0,l.useState)(""),[w,Z]=(0,l.useState)(""),[M,C]=(0,l.useState)(""),[z,F]=(0,l.useState)(""),[_,D]=(0,l.useState)(!1),[I,P]=(0,l.useState)(!1),S=e=>{if(!e)return;let a=Array.from(e).filter(e=>{let a=e.type.startsWith("image/")||"application/pdf"===e.type,t=e.size<=10485760;return a?!!t||((0,j.Am)({title:"ไฟล์ใหญ่เกินไป",description:`${e.name} มีขนาดเกิน 10MB`,variant:"destructive"}),!1):((0,j.Am)({title:"ไฟล์ไม่ถูกต้อง",description:`${e.name} ไม่ใช่ไฟล์รูปภาพหรือ PDF`,variant:"destructive"}),!1)});f(e=>[...e,...a])},A=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?P(!0):"dragleave"===e.type&&P(!1)},B=e=>{f(a=>a.filter((a,t)=>t!==e))},$=async()=>{if(0===N.length){(0,j.Am)({title:"กรุณาเลือกไฟล์",description:"กรุณาอัปโหลดสลิปหรือใบเสร็จ",variant:"destructive"});return}D(!0);try{await new Promise(e=>setTimeout(e,2e3));let e=m.X.createReceipt({donationId:`manual_${Date.now()}`,requestId:t,requestTitle:g,donorId:"manual_upload",donorName:M||"ไม่ระบุชื่อ",amount:w?Number(w):void 0,type:"money",paymentMethod:"Manual Upload",transactionId:b,message:z,isAnonymous:!M,pointsEarned:0}),s=N.map(e=>({name:e.name,size:e.size,type:e.type,url:URL.createObjectURL(e)}));localStorage.setItem(`receipt_files_${e.id}`,JSON.stringify(s)),(0,j.Am)({title:"อัปโหลดสำเร็จ",description:"สลิปการรับเงินได้ถูกบันทึกแล้ว"}),f([]),k(""),Z(""),C(""),F(""),v?.(),a()}catch(e){(0,j.Am)({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถอัปโหลดไฟล์ได้ กรุณาลองใหม่",variant:"destructive"})}finally{D(!1)}},q=e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},R=()=>{f([]),k(""),Z(""),C(""),F(""),D(!1),P(!1)},T=()=>{R(),a()};return s.jsx(r.Vq,{open:e,onOpenChange:T,children:(0,s.jsxs)(r.cZ,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(r.fK,{children:[s.jsx(r.$N,{children:"อัปโหลดสลิปการรับเงิน"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["สำหรับ: ",g]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx(d._,{children:"สลิปการรับเงิน / ใบเสร็จ *"}),(0,s.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${I?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:A,onDragLeave:A,onDragOver:A,onDrop:e=>{e.preventDefault(),e.stopPropagation(),P(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&S(e.dataTransfer.files)},children:[s.jsx(h.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-lg font-medium text-gray-700 mb-2",children:"ลากไฟล์มาวางที่นี่ หรือคลิกเพื่อเลือกไฟล์"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"รองรับไฟล์ JPG, PNG, PDF ขนาดไม่เกิน 10MB"}),s.jsx(i.z,{type:"button",variant:"outline",onClick:()=>document.getElementById("file-upload")?.click(),children:"เลือกไฟล์"}),s.jsx("input",{id:"file-upload",type:"file",multiple:!0,accept:"image/*,.pdf",onChange:e=>S(e.target.files),className:"hidden"})]}),N.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(d._,{children:["ไฟล์ที่เลือก (",N.length,")"]}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:N.map((e,a)=>s.jsx(o.Zb,{children:s.jsx(o.aY,{className:"p-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx(p,{className:"w-5 h-5 text-blue-600"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium truncate max-w-[200px]",children:e.name}),s.jsx("p",{className:"text-xs text-gray-500",children:q(e.size)})]})]}),s.jsx(i.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>B(a),children:s.jsx(x.Z,{className:"w-4 h-4"})})]})})},a))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(d._,{htmlFor:"receiptNumber",children:"เลขที่ใบเสร็จ / รหัสอ้างอิง"}),s.jsx(n.I,{id:"receiptNumber",placeholder:"เช่น RCP-001234",value:b,onChange:e=>k(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(d._,{htmlFor:"amount",children:"จำนวนเงิน (บาท)"}),s.jsx(n.I,{id:"amount",type:"number",placeholder:"0.00",value:w,onChange:e=>Z(e.target.value),min:"0",step:"0.01"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(d._,{htmlFor:"donorName",children:"ชื่อผู้บริจาค (ไม่บังคับ)"}),s.jsx(n.I,{id:"donorName",placeholder:"ระบุชื่อผู้บริจาค หรือเว้นว่างหากไม่ประสงค์ออกนาม",value:M,onChange:e=>C(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(d._,{htmlFor:"notes",children:"หมายเหตุเพิ่มเติม"}),s.jsx(c.g,{id:"notes",placeholder:"รายละเอียดเพิ่มเติมเกี่ยวกับการรับเงิน...",rows:3,value:z,onChange:e=>F(e.target.value)})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[s.jsx(u.Z,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,s.jsxs)("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"ข้อมูลสำคัญ:"}),(0,s.jsxs)("ul",{className:"space-y-1 text-xs",children:[s.jsx("li",{children:"• สลิปที่อัปโหลดจะถูกเก็บไว้เป็นหลักฐานการรับเงิน"}),s.jsx("li",{children:"• ข้อมูลจะถูกใช้สำหรับการออกใบเสร็จและรายงาน"}),s.jsx("li",{children:"• กรุณาตรวจสอบความถูกต้องของข้อมูลก่อนอัปโหลด"})]})]})]})}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[s.jsx(i.z,{onClick:$,disabled:_||0===N.length,className:"flex-1",children:_?(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"กำลังอัปโหลด..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"อัปโหลดสลิป"]})}),s.jsx(i.z,{variant:"outline",onClick:T,disabled:_,children:"ยกเลิก"})]})]})]})})}},41291:(e,a,t)=>{t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},83855:(e,a,t)=>{t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},95964:(e,a,t)=>{t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]])},17069:(e,a,t)=>{t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},63685:(e,a,t)=>{t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}};