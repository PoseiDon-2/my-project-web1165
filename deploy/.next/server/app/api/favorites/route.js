"use strict";(()=>{var e={};e.id=4121,e.ids=[4121],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},8638:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>x,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var o={};r.r(o),r.d(o,{GET:()=>c,POST:()=>l});var s=r(49303),a=r(88716),n=r(60670),i=r(87070),u=r(24544),p=r(92704);async function l(e){try{let t=await (0,p.lj)(e);if(200!==t.status)return t;let r=e.headers.get("x-user-id"),{requestId:o}=await e.json();if(!o)return i.NextResponse.json({error:"กรุณาระบุ ID ของคำขอ"},{status:400});let s=await u.zl.toggle(r,o);return i.NextResponse.json({message:"added"===s.action?"เพิ่มในรายการโปรดแล้ว":"ลบออกจากรายการโปรดแล้ว",action:s.action})}catch(e){return console.error("Toggle favorite error:",e),i.NextResponse.json({error:"เกิดข้อผิดพลาดในการจัดการรายการโปรด"},{status:500})}}async function c(e){try{let t=await (0,p.lj)(e);if(200!==t.status)return t;let r=e.headers.get("x-user-id"),{searchParams:o}=new URL(e.url),s=parseInt(o.get("page")||"1"),a=parseInt(o.get("limit")||"10"),n=await u.zl.getByUser(r,s,a);return i.NextResponse.json(n)}catch(e){return console.error("Get favorites error:",e),i.NextResponse.json({error:"เกิดข้อผิดพลาดในการดึงรายการโปรด"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/favorites/route",pathname:"/api/favorites",filename:"route",bundlePath:"app/api/favorites/route"},resolvedPagePath:"D:\\testProject\\test-project\\app\\api\\favorites\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:x,staticGenerationAsyncStorage:g,serverHooks:f}=d,h="/api/favorites/route";function v(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},92704:(e,t,r)=>{r.d(t,{So:()=>n,lj:()=>a});var o=r(87070),s=r(90455);async function a(e){let t=e.headers.get("authorization")?.replace("Bearer ","")||e.cookies.get("auth-token")?.value;if(!t)return o.NextResponse.json({error:"ไม่พบ token การยืนยันตัวตน"},{status:401});let r=await (0,s.WX)(t);if(!r)return o.NextResponse.json({error:"Token ไม่ถูกต้องหรือหมดอายุ"},{status:401});let a=new Headers(e.headers);return a.set("x-user-id",r.id),a.set("x-user-role",r.role),o.NextResponse.next({request:{headers:a}})}async function n(e){let t=e.headers.get("authorization")?.replace("Bearer ","")||e.cookies.get("auth-token")?.value;if(!t)return console.log("No token provided"),null;let r=await (0,s.WX)(t);return console.log("Authenticated user:",r),r||null}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[9276,5972,1482,8691,1585,603],()=>r(8638));module.exports=o})();