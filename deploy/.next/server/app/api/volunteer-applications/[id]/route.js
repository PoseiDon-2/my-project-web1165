"use strict";(()=>{var e={};e.id=1231,e.ids=[1231],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},40948:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>q,requestAsyncStorage:()=>x,routeModule:()=>v,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{PATCH:()=>m,dynamic:()=>c});var s=r(49303),i=r(88716),o=r(60670),n=r(87070),p=r(72331),u=r(53524),l=r(41482),d=r.n(l);let c="force-dynamic";async function m(e,{params:t}){try{let r=e.headers.get("Authorization");if(!r||!r.startsWith("Bearer "))return n.NextResponse.json({error:"กรุณาเข้าสู่ระบบ"},{status:401});let a=r.split(" ")[1],s=d().verify(a,process.env.JWT_SECRET||"").userId,{id:i}=t,{status:o}=await e.json();if(!Object.values(u.VolunteerStatus).includes(o))return n.NextResponse.json({error:"สถานะไม่ถูกต้อง"},{status:400});let l=await p._.volunteerApplication.findUnique({where:{id:i},include:{request:!0}});if(!l||l.request.organizerId!==s)return n.NextResponse.json({error:"ไม่พบใบสมัครหรือไม่มีสิทธิ์"},{status:404});let c=await p._.volunteerApplication.update({where:{id:i},data:{status:o},select:{id:!0,message:!0,skills:!0,experience:!0,availability:!0,status:!0,hoursCommitted:!0,startDate:!0,endDate:!0,approvedAt:!0,completedAt:!0,requestId:!0,volunteer:{select:{id:!0,firstName:!0,lastName:!0,email:!0,phone:!0}}}});return n.NextResponse.json({id:c.id,name:`${c.volunteer.firstName??""} ${c.volunteer.lastName??""}`.trim(),email:c.volunteer.email,phone:c.volunteer.phone||"",message:c.message,skills:c.skills?JSON.parse(c.skills):[],experience:c.experience||"",availability:c.availability||"",status:c.status.toLowerCase(),hoursCommitted:c.hoursCommitted||0,startDate:c.startDate?.toISOString()||"",endDate:c.endDate?.toISOString()||"",approvedAt:c.approvedAt?.toISOString()||"",completedAt:c.completedAt?.toISOString()||"",requestId:c.requestId})}catch(e){return console.error("Error updating volunteer application:",e),n.NextResponse.json({error:"เกิดข้อผิดพลาดในการอัปเดตสถานะใบสมัคร"},{status:500})}}let v=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/volunteer-applications/[id]/route",pathname:"/api/volunteer-applications/[id]",filename:"route",bundlePath:"app/api/volunteer-applications/[id]/route"},resolvedPagePath:"D:\\testProject\\test-project\\app\\api\\volunteer-applications\\[id]\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:x,staticGenerationAsyncStorage:h,serverHooks:g}=v,f="/api/volunteer-applications/[id]/route";function q(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},72331:(e,t,r)=>{r.d(t,{_:()=>s});var a=r(53524);let s=globalThis.prisma??new a.PrismaClient}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972,1482],()=>r(40948));module.exports=a})();