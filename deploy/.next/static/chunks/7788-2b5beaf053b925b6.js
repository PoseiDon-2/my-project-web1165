"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7788],{1121:function(e,t,a){a.d(t,{Z:function(){return w}});var s=a(7437),n=a(2265),r=a(8919),c=a(2489),i=a(401),o=a(8867),l=a(2351),d=a(2718),h=a(9345),m=a(7404),x=a(6362),p=a(2869),u=a(6070),g=a(6512),f=a(4738),j=a(7992);function w(e){let{isOpen:t,onClose:a,donation:w,initialShowQR:y=!1}=e,[N,v]=(0,n.useState)(!1),[b,k]=(0,n.useState)(y),{user:C}=(0,f.a)();if(!t)return null;let T="".concat("https://donation-swipe.cpkku.com","/requests/").concat(w.id),S="ช่วยเหลือ: ".concat(w.title),A="".concat(w.description.substring(0,100),"... เป้าหมาย ฿").concat(w.goalAmount.toLocaleString("th-TH")," โดย ").concat(w.organizer),R=async e=>{try{if(C&&!(await fetch("/api/interactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:C.id,entityType:"DonationRequest",entityId:w.id,interactionType:"SHARE",interactionValue:3})})).ok)throw Error("Failed to record SHARE interaction")}catch(e){console.error("Failed to record SHARE:",e),(0,j.Am)({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถบันทึกการแชร์ได้ กรุณาลองใหม่",variant:"destructive"})}},I=async()=>{try{await navigator.clipboard.writeText(T),v(!0),setTimeout(()=>v(!1),2e3),await R("clipboard")}catch(e){console.error("Failed to copy: ",e),(0,j.Am)({title:"เกิดข้อผิดพลาด",description:"ไม่สามารถคัดลอกลิงก์ได้",variant:"destructive"})}},E=async()=>{let e="https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(T),"&quote=").concat(encodeURIComponent(S+" - "+A));window.open(e,"_blank","width=600,height=400"),await R("facebook")},z=async()=>{let e="".concat(S,"\n\n").concat(A,"\n\n#บริจาค #ช่วยเหลือ"),t="https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(e),"&url=").concat(encodeURIComponent(T));window.open(t,"_blank","width=600,height=400"),await R("twitter")},_=async()=>{let e="".concat(S,"\n\n").concat(A),t="https://social-plugins.line.me/lineit/share?url=".concat(encodeURIComponent(T),"&text=").concat(encodeURIComponent(e));window.open(t,"_blank","width=600,height=400"),await R("line")},Z=async()=>{let e="".concat(S,"\n\n").concat(A,"\n\n").concat(T),t="https://wa.me/?text=".concat(encodeURIComponent(e));window.open(t,"_blank"),await R("whatsapp")},O=async()=>{encodeURIComponent(S),encodeURIComponent("".concat(A,"\n\nดูรายละเอียดเพิ่มเติม: ").concat(T)),await R("email")};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)(u.Zb,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)(u.Ol,{className:"pb-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(u.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(r.Z,{className:"w-5 h-5 text-pink-500"}),"แชร์คำขอบริจาค"]}),(0,s.jsx)(p.z,{variant:"ghost",size:"sm",onClick:a,children:(0,s.jsx)(c.Z,{className:"w-4 h-4"})})]})}),(0,s.jsxs)(u.aY,{className:"space-y-6",children:[(0,s.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("img",{src:w.imageUrl||"/placeholder.svg",alt:w.title,className:"w-16 h-16 rounded-lg object-cover"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"font-medium text-sm text-gray-800 line-clamp-2",children:w.title}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["เป้าหมาย ฿",w.goalAmount.toLocaleString("th-TH")]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["โดย ",w.organizer]})]})]})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-800",children:"คัดลอกลิงก์"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("div",{className:"flex-1 px-3 py-2 bg-gray-100 rounded-lg text-sm text-gray-600 truncate",children:T}),(0,s.jsx)(p.z,{variant:"outline",size:"sm",onClick:I,className:"".concat(N?"bg-green-50 border-green-200 text-green-700":"bg-transparent"),children:N?(0,s.jsx)(i.Z,{className:"w-4 h-4"}):(0,s.jsx)(o.Z,{className:"w-4 h-4"})})]}),N&&(0,s.jsx)("p",{className:"text-sm text-green-600 text-center",children:"✓ คัดลอกลิงก์แล้ว!"})]}),(0,s.jsx)(g.Z,{}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-800",children:"แชร์ผ่านโซเชียลมีเดีย"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)(p.z,{variant:"outline",className:"flex items-center gap-2 justify-start bg-transparent hover:bg-blue-50 hover:border-blue-200",onClick:E,children:[(0,s.jsx)("div",{className:"w-5 h-5 bg-blue-600 rounded flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:"f"})}),"Facebook"]}),(0,s.jsxs)(p.z,{variant:"outline",className:"flex items-center gap-2 justify-start bg-transparent hover:bg-sky-50 hover:border-sky-200",onClick:z,children:[(0,s.jsx)(l.Z,{className:"w-5 h-5 text-sky-500"}),"Twitter"]}),(0,s.jsxs)(p.z,{variant:"outline",className:"flex items-center gap-2 justify-start bg-transparent hover:bg-green-50 hover:border-green-200",onClick:_,children:[(0,s.jsx)("div",{className:"w-5 h-5 bg-green-500 rounded flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-xs font-bold",children:"LINE"})}),"Line"]}),(0,s.jsxs)(p.z,{variant:"outline",className:"flex items-center gap-2 justify-start bg-transparent hover:bg-green-50 hover:border-green-200",onClick:Z,children:[(0,s.jsx)(d.Z,{className:"w-5 h-5 text-green-600"}),"WhatsApp"]}),(0,s.jsxs)(p.z,{variant:"outline",className:"flex items-center gap-2 justify-start bg-transparent hover:bg-gray-50 hover:border-gray-300",onClick:O,children:[(0,s.jsx)(h.Z,{className:"w-5 h-5 text-gray-600"}),"Email"]}),(0,s.jsxs)(p.z,{variant:"outline",className:"flex items-center gap-2 justify-start bg-transparent hover:bg-purple-50 hover:border-purple-200",onClick:()=>k(!b),children:[(0,s.jsx)(m.Z,{className:"w-5 h-5 text-purple-600"}),"QR Code"]})]})]}),b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Z,{}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-800",children:"QR Code สำหรับแชร์"}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"inline-block p-4 bg-white border-2 border-dashed border-gray-300 rounded-lg",children:(0,s.jsx)("img",{src:"https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=".concat(encodeURIComponent(T))||"/placeholder.svg",alt:"QR Code สำหรับแชร์",className:"w-32 h-32 mx-auto"})}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"สแกน QR Code เพื่อเปิดลิงก์"})]})]})]}),"undefined"!=typeof navigator&&navigator.share&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Z,{}),(0,s.jsxs)(p.z,{variant:"outline",className:"w-full bg-transparent",onClick:async()=>{try{await navigator.share({title:S,text:A,url:T}),await R("native")}catch(e){console.error("Native share failed:",e)}},children:[(0,s.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),"แชร์ผ่านแอปอื่นๆ"]})]})]})]})})}},2759:function(e,t,a){a.d(t,{E:function(){return i}});var s=a(7437),n=a(2265),r=a(610),c=a(4508);let i=n.forwardRef((e,t)=>{let{className:a,value:n,...i}=e;return(0,s.jsx)(r.fC,{ref:t,className:(0,c.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...i,children:(0,s.jsx)(r.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});i.displayName=r.fC.displayName},6512:function(e,t,a){a.d(t,{Z:function(){return i}});var s=a(7437),n=a(2265),r=a(5156),c=a(4508);let i=n.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:i=!0,...o}=e;return(0,s.jsx)(r.f,{ref:t,decorative:i,orientation:n,className:(0,c.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a),...o})});i.displayName=r.f.displayName},7992:function(e,t,a){a.d(t,{Am:function(){return d}}),a(2265);let s=0,n=new Map,r=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},c=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?r(a):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],o={toasts:[]};function l(e){o=c(o,e),i.forEach(e=>{e(o)})}function d(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>l({type:"DISMISS_TOAST",toastId:a});return l({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||n()}}}),{id:a,dismiss:n,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:a}})}}}}]);