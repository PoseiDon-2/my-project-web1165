(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4011],{9227:function(e,t,a){Promise.resolve().then(a.bind(a,5900))},5900:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return R}});var r=a(7437),s=a(2265),n=a(9376),i=a(1671),l=a(2660),o=a(2369),d=a(9345),c=a(3041),u=a(6337),m=a(7769),p=a(2208),x=a(8997),g=a(7689),h=a(8736),f=a(2869),N=a(6070),y=a(5186),v=a(6815),j=a(5613),b=a(4738),w=a(3647),C=a(2759),z=a(1800),D=a(875);function k(e){let{options:t,value:a,onChange:n,placeholder:i,disabled:l}=e,[o,d]=(0,s.useState)(""),[c,u]=(0,s.useState)(!1),m=(0,s.useRef)(null),p=""===o?t:t.filter(e=>e.label.toLowerCase().includes(o.toLowerCase()));return(0,s.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.jsxs)("div",{ref:m,className:"relative w-full",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-500 ".concat(l?"bg-gray-100 cursor-not-allowed":""),value:o,onChange:e=>{d(e.target.value),u(!0)},onFocus:()=>u(!0),placeholder:i,disabled:l}),(0,r.jsx)("button",{type:"button",className:"absolute right-0 top-0 h-full px-3 flex items-center",onClick:()=>u(!c),disabled:l,children:(0,r.jsx)(D.Z,{className:"h-4 w-4 text-gray-400"})})]}),c&&(0,r.jsx)("ul",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5",children:0===p.length?(0,r.jsx)("li",{className:"relative cursor-default select-none py-2 px-4 text-gray-700",children:"ไม่พบองค์กร"}):p.map(e=>(0,r.jsx)("li",{className:"relative cursor-pointer select-none py-2 px-4 ".concat(a===e.value?"bg-pink-100 text-pink-900":"text-gray-900 hover:bg-pink-100 hover:text-pink-900"),onClick:()=>{n(e.value),d(""),u(!1)},children:e.label},e.value))})]})}let I=[{id:"disaster-relief",label:"ช่วยเหลือภัยพิบัติ",description:"น้ำท่วม แผ่นดินไหว ไฟไหม้ ภัยแล้ง",icon:"\uD83C\uDF0A",category:"disaster"},{id:"medical-health",label:"การแพทย์และสุขภาพ",description:"โรงพยาบาล อุปกรณ์การแพทย์ การรักษา",icon:"\uD83C\uDFE5",category:"medical"},{id:"education-learning",label:"การศึกษาและการเรียนรู้",description:"โรงเรียน มหาวิทยาลัย ทุนการศึกษา",icon:"\uD83D\uDCDA",category:"education"},{id:"animal-welfare",label:"สวัสดิภาพสัตว์",description:"สุนัขจรจัด แมวจรจัด สัตว์ป่า",icon:"\uD83D\uDC15",category:"animal"},{id:"environment",label:"สิ่งแวดล้อม",description:"ปลูกป่า ลดขยะ พลังงานสะอาด",icon:"\uD83C\uDF31",category:"environment"},{id:"elderly-care",label:"ดูแลผู้สูงอายุ",description:"บ้านพักคนชรา กิจกรรมผู้สูงอายุ",icon:"\uD83D\uDC74",category:"elderly"},{id:"children-youth",label:"เด็กและเยาวชน",description:"สถานเลี้ยงเด็กกำพร้า กิจกรรมเด็ก",icon:"\uD83D\uDC76",category:"children"},{id:"disability-support",label:"ผู้พิการ",description:"ศูนย์ผู้พิการ อุปกรณ์ช่วยเหลือ",icon:"♿",category:"disability"},{id:"community-development",label:"พัฒนาชุมชน",description:"โครงการชุมชน สาธารณูปโภค",icon:"\uD83C\uDFD8️",category:"community"},{id:"religious-spiritual",label:"ศาสนาและจิตวิญญาณ",description:"วัด โบสถ์ มัสยิด กิจกรรมศาสนา",icon:"\uD83D\uDE4F",category:"religion"},{id:"arts-culture",label:"ศิลปะและวัฒนธรรม",description:"การแสดง ดนตรี ศิลปกรรม",icon:"\uD83C\uDFA8",category:"arts"},{id:"sports-recreation",label:"กีฬาและนันทนาการ",description:"อุปกรณ์กีฬา สนามเด็กเล่น",icon:"⚽",category:"sports"}],O=[{value:"NGO",label:"องค์กรไม่แสวงหาผลกำไร",icon:"\uD83C\uDF1F"},{value:"CHARITY",label:"การกุศล",icon:"\uD83E\uDD1D"},{value:"FOUNDATION",label:"มูลนิธิ",icon:"\uD83C\uDFDB️"},{value:"GOVERNMENT",label:"หน่วยงานราชการ",icon:"\uD83C\uDFDB️"},{value:"TEMPLE",label:"วัด/สถานที่ศักดิ์สิทธิ์",icon:"\uD83C\uDFDB️"},{value:"OTHER",label:"อื่นๆ",icon:"\uD83D\uDCCC"}];function R(){let e=(0,n.useRouter)(),{register:t,sendOTP:a,verifyOTP:D,isLoading:R}=(0,b.a)(),[T,Z]=(0,s.useState)("info"),[F,P]=(0,s.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phone:"",role:"user",organizationId:"",newOrganizationName:"",organizationType:"",registrationNumber:"",templeId:"",interests:[],documents:{idCard:null,organizationCert:null}}),[E,_]=(0,s.useState)(!1),[A,S]=(0,s.useState)(!1),[G,B]=(0,s.useState)(""),[L,q]=(0,s.useState)(""),[M,V]=(0,s.useState)(!1),[Y,$]=(0,s.useState)([]),[H,J]=(0,s.useState)(!1);(0,s.useEffect)(()=>{"ORGANIZER"===F.role&&(async()=>{J(!0);try{let e=await fetch("/api/organizations");if(!e.ok)throw Error("Failed to fetch organizations");let t=await e.json();$(t)}catch(e){B("ไม่สามารถโหลดรายชื่อองค์กรได้ กรุณาลองใหม่")}finally{J(!1)}})()},[F.role]);let X=async e=>{if(e.preventDefault(),B(""),"info"===T){if(!F.email||!F.password||!F.firstName||!F.lastName||!F.phone){B("กรุณากรอกข้อมูลพื้นฐานให้ครบถ้วน");return}if(F.password!==F.confirmPassword){B("รหัสผ่านและยืนยันรหัสผ่านไม่ตรงกัน");return}if(F.password.length<6){B("รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร");return}if(!/^[0-9-]+$/.test(F.phone)){B("เบอร์โทรศัพท์ต้องมีเฉพาะตัวเลขและเครื่องหมาย -");return}if("ORGANIZER"===F.role){if(!F.organizationId&&!F.newOrganizationName){B("กรุณาเลือกองค์กรที่มีอยู่หรือระบุชื่อองค์กรใหม่");return}if(!F.organizationType){B("กรุณาเลือกประเภทองค์กร");return}if("other"===F.organizationId&&!F.newOrganizationName){B("กรุณาระบุชื่อองค์กรใหม่");return}if("TEMPLE"===F.organizationType&&!F.templeId){B("กรุณาระบุเลขวัด");return}if(["NGO","CHARITY","FOUNDATION","GOVERNMENT"].includes(F.organizationType)&&!F.registrationNumber){B("กรุณาระบุเลขนิติบุคคล");return}if(F.templeId&&!/^\d+$/.test(F.templeId)){B("เลขวัดต้องประกอบด้วยตัวเลขเท่านั้น");return}if(F.registrationNumber&&!/^\d{13}$/.test(F.registrationNumber)){B("เลขนิติบุคคลต้องเป็นตัวเลข 13 หลัก");return}Z("documents")}else Z("interests")}else if("interests"===T)0===F.interests.length&&B("แนะนำให้เลือกความสนใจอย่างน้อย 1 หมวดหมู่เพื่อประสบการณ์ที่ดีขึ้น"),await Q();else if("documents"===T){if(!F.documents.idCard||!F.documents.organizationCert){B("กรุณาแนบเอกสารทั้งบัตรประชาชนและหนังสือรับรององค์กร");return}await Q()}else"otp"===T&&await U()},Q=async()=>{try{await a(F.email)?(V(!0),Z("otp")):B("ไม่สามารถส่ง OTP ได้ กรุณาลองใหม่")}catch(e){B("เกิดข้อผิดพลาดในการส่ง OTP กรุณาลองใหม่")}},U=async()=>{if(!L||6!==L.length){B("กรุณากรอกรหัส OTP 6 หลัก");return}try{await D(F.email,L)?await t({email:F.email,password:F.password,firstName:F.firstName,lastName:F.lastName,phone:F.phone,role:F.role,organizationId:"other"===F.organizationId?void 0:F.organizationId,newOrganizationName:"other"===F.organizationId?F.newOrganizationName:void 0,organizationType:F.organizationType,registrationNumber:F.registrationNumber||void 0,templeId:F.templeId||void 0,interests:F.interests,documents:F.documents})?(Z("success"),setTimeout(()=>{e.push("/profile")},3e3)):B("อีเมลนี้ถูกใช้งานแล้ว กรุณาใช้อีเมลอื่น"):B("รหัส OTP ไม่ถูกต้อง กรุณาตรวจสอบ")}catch(e){B("เกิดข้อผิดพลาดในการยืนยัน OTP กรุณาลองใหม่")}},W=(e,t)=>{P({...F,[e]:t})},K=(e,t)=>{P(a=>({...a,interests:t?[...new Set([...a.interests,e])]:a.interests.filter(t=>t!==e)}))},ee=(e,t)=>{if(t&&t.size>5242880){B("ไฟล์ต้องมีขนาดไม่เกิน 5MB");return}if(t&&!["application/pdf","image/jpeg","image/png"].includes(t.type)){B("ไฟล์ต้องเป็น PDF, JPG หรือ PNG เท่านั้น");return}P({...F,documents:{...F.documents,[e]:t}})},et=()=>{"interests"===T?Z("info"):"documents"===T?Z("info"):"otp"===T&&("ORGANIZER"===F.role?Z("documents"):Z("interests"))};return"success"===T?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 flex items-center justify-center p-4",children:(0,r.jsx)(N.Zb,{className:"w-full max-w-md text-center",children:(0,r.jsxs)(N.aY,{className:"p-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(i.Z,{className:"w-8 h-8 text-green-600"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"สมัครสมาชิกสำเร็จ!"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"ORGANIZER"===F.role?"บัญชีของคุณอยู่ระหว่างการตรวจสอบเอกสาร":"ยินดีต้อนรับสู่ DonateSwipe"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"กำลังนำคุณไปยังหน้าโปรไฟล์..."})]})})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsxs)(f.z,{variant:"ghost",onClick:()=>"info"===T?e.push("/login"):et(),className:"absolute top-4 left-4 hover:bg-pink-50",children:[(0,r.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"กลับ"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"\uD83D\uDC9D DonateSwipe"}),(0,r.jsx)("p",{className:"text-gray-600",children:"สร้างบัญชีเพื่อเริ่มช่วยเหลือผู้อื่น"})]}),(0,r.jsxs)(N.Zb,{className:"shadow-xl border-0",children:[(0,r.jsxs)(N.Ol,{className:"text-center pb-4",children:[(0,r.jsxs)(N.ll,{className:"text-2xl font-bold text-gray-800",children:["info"===T&&"ข้อมูลพื้นฐาน","interests"===T&&"ความสนใจของคุณ","documents"===T&&"แนบเอกสาร","otp"===T&&"ยืนยันอีเมล"]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)(C.E,{value:(()=>{let e="ORGANIZER"===F.role?["info","documents","otp","success"]:["info","interests","otp","success"];return(e.indexOf(T)+1)/e.length*100})(),className:"h-2"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["ขั้นตอนที่"," ","ORGANIZER"===F.role?["info","documents","otp"].indexOf(T)+1:["info","interests","otp"].indexOf(T)+1," ","จาก ",(F.role,"3")]})]})]}),(0,r.jsxs)(N.aY,{className:"space-y-6",children:[(0,r.jsxs)("form",{onSubmit:X,className:"space-y-4",children:[G&&(0,r.jsx)(j.bZ,{className:"border-red-200 bg-red-50",children:(0,r.jsx)(j.X,{className:"text-red-700",children:G})}),"info"===T&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"firstName",className:"text-gray-700",children:"ชื่อ *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(o.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)(y.I,{id:"firstName",name:"firstName",type:"text",placeholder:"ชื่อ",value:F.firstName,onChange:e=>W(e.target.name,e.target.value),className:"pl-10",required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"lastName",className:"text-gray-700",children:"นามสกุล *"}),(0,r.jsx)(y.I,{id:"lastName",name:"lastName",type:"text",placeholder:"นามสกุล",value:F.lastName,onChange:e=>W(e.target.name,e.target.value),required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"email",className:"text-gray-700",children:"อีเมล *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)(y.I,{id:"email",name:"email",type:"email",placeholder:"กรอกอีเมลของคุณ",value:F.email,onChange:e=>W(e.target.name,e.target.value),className:"pl-10",required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"phone",className:"text-gray-700",children:"เบอร์โทรศัพท์ *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)(y.I,{id:"phone",name:"phone",type:"tel",placeholder:"081-234-5678",value:F.phone,onChange:e=>W(e.target.name,e.target.value),className:"pl-10",required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"role",className:"text-gray-700",children:"ประเภทบัญชี *"}),(0,r.jsxs)(w.Ph,{value:F.role,onValueChange:e=>{P({...F,role:"user"===e?"DONOR":"ORGANIZER",organizationId:"",newOrganizationName:"",organizationType:"",registrationNumber:"",templeId:""})},children:[(0,r.jsx)(w.i4,{children:(0,r.jsx)(w.ki,{placeholder:"เลือกประเภทบัญชี"})}),(0,r.jsxs)(w.Bw,{children:[(0,r.jsx)(w.Ql,{value:"user",children:"ผู้ใช้ทั่วไป"}),(0,r.jsx)(w.Ql,{value:"ORGANIZER",children:"ผู้จัดการองค์กร"})]})]})]}),"ORGANIZER"===F.role&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"organizationId",className:"text-gray-700",children:"ชื่อองค์กร *"}),(0,r.jsx)(k,{options:[...Y.map(e=>({value:e.id,label:"".concat(e.name," (").concat(e.type,")")})),{value:"other",label:"อื่นๆ (ระบุชื่อใหม่)"}],value:F.organizationId,onChange:e=>{P({...F,organizationId:e,newOrganizationName:"other"===e?F.newOrganizationName:""})},placeholder:H?"กำลังโหลดองค์กร...":"ค้นหาหรือเลือกองค์กร...",disabled:H})]}),"other"===F.organizationId&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"newOrganizationName",className:"text-gray-700",children:"ระบุชื่อองค์กรใหม่ *"}),(0,r.jsx)(y.I,{id:"newOrganizationName",name:"newOrganizationName",type:"text",placeholder:"เช่น มูลนิธิบ้านน้ำใจ",value:F.newOrganizationName,onChange:e=>W(e.target.name,e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"organizationType",className:"text-gray-700",children:"ประเภทองค์กร *"}),(0,r.jsxs)(w.Ph,{value:F.organizationType,onValueChange:e=>{P({...F,organizationType:e,registrationNumber:"",templeId:""})},children:[(0,r.jsx)(w.i4,{children:(0,r.jsx)(w.ki,{placeholder:"เลือกประเภทองค์กร"})}),(0,r.jsx)(w.Bw,{children:O.map(e=>(0,r.jsx)(w.Ql,{value:e.value,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:e.icon}),(0,r.jsx)("span",{children:e.label})]})},e.value))})]})]}),F.organizationType&&"TEMPLE"!==F.organizationType&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(v._,{htmlFor:"registrationNumber",className:"text-gray-700",children:["เลขนิติบุคคล ","OTHER"!==F.organizationType?"*":"(ถ้ามี)"]}),(0,r.jsx)(y.I,{id:"registrationNumber",name:"registrationNumber",type:"text",placeholder:"เช่น 0123456789012",value:F.registrationNumber,onChange:e=>W(e.target.name,e.target.value),required:"OTHER"!==F.organizationType})]}),"TEMPLE"===F.organizationType&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"templeId",className:"text-gray-700",children:"เลขวัด *"}),(0,r.jsx)(y.I,{id:"templeId",name:"templeId",type:"text",placeholder:"เช่น 123456",value:F.templeId,onChange:e=>W(e.target.name,e.target.value),required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"password",className:"text-gray-700",children:"รหัสผ่าน *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)(y.I,{id:"password",name:"password",type:E?"text":"password",placeholder:"สร้างรหัสผ่าน (อย่างน้อย 6 ตัวอักษร)",value:F.password,onChange:e=>W(e.target.name,e.target.value),className:"pl-10 pr-10",required:!0}),(0,r.jsx)(f.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0",onClick:()=>_(!E),children:E?(0,r.jsx)(m.Z,{className:"w-4 h-4"}):(0,r.jsx)(p.Z,{className:"w-4 h-4"})})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"confirmPassword",className:"text-gray-700",children:"ยืนยันรหัสผ่าน *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)(y.I,{id:"confirmPassword",name:"confirmPassword",type:A?"text":"password",placeholder:"ยืนยันรหัสผ่าน",value:F.confirmPassword,onChange:e=>W(e.target.name,e.target.value),className:"pl-10 pr-10",required:!0}),(0,r.jsx)(f.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0",onClick:()=>S(!A),children:A?(0,r.jsx)(m.Z,{className:"w-4 h-4"}):(0,r.jsx)(p.Z,{className:"w-4 h-4"})})]})]})]}),"interests"===T&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-pink-50 p-4 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(x.Z,{className:"w-5 h-5 text-pink-600"}),(0,r.jsx)("h4",{className:"font-medium text-pink-800",children:"เลือกความสนใจของคุณ"})]}),(0,r.jsx)("p",{className:"text-sm text-pink-700",children:"เลือกหมวดหมู่ที่คุณสนใจเพื่อให้เราแนะนำการบริจาคที่เหมาะสมกับคุณ"})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-3 max-h-96 overflow-y-auto",children:I.map(e=>(0,r.jsx)("label",{htmlFor:e.id,className:"block border rounded-lg p-4 cursor-pointer transition-all ".concat(F.interests.includes(e.id)?"border-pink-300 bg-pink-50":"border-gray-200 hover:border-pink-200 hover:bg-pink-50"),children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(z.X,{id:e.id,checked:F.interests.includes(e.id),onCheckedChange:t=>K(e.id,!!t),className:"mt-1"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("span",{className:"text-lg",children:e.icon}),(0,r.jsx)("h5",{className:"font-medium text-gray-800",children:e.label})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})]})},e.id))}),(0,r.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-blue-700",children:["\uD83D\uDCA1 ",(0,r.jsxs)("strong",{children:["เลือกแล้ว ",F.interests.length," หมวดหมู่"]}),F.interests.length>0&&" - คุณสามารถเปลี่ยนแปลงได้ในภายหลัง"]})})]})}),"documents"===T&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"\uD83D\uDCCB เอกสารที่ต้องแนบ"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,r.jsx)("li",{children:"• สำเนาบัตรประจำตัวประชาชน"}),(0,r.jsx)("li",{children:"• หนังสือรับรองการจดทะเบียนองค์กร"}),(0,r.jsx)("li",{children:"• ไฟล์ต้องเป็น PDF, JPG หรือ PNG ขนาดไม่เกิน 5MB"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{className:"text-gray-700",children:"สำเนาบัตรประจำตัวประชาชน *"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,r.jsx)("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{var t;return ee("idCard",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"hidden",id:"idCard"}),(0,r.jsx)("label",{htmlFor:"idCard",className:"cursor-pointer",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(g.Z,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:F.documents.idCard?F.documents.idCard.name:"คลิกเพื่อเลือกไฟล์"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PDF, JPG, PNG (ไม่เกิน 5MB)"})]})})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{className:"text-gray-700",children:"หนังสือรับรององค์กร *"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,r.jsx)("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{var t;return ee("organizationCert",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"hidden",id:"organizationCert"}),(0,r.jsx)("label",{htmlFor:"organizationCert",className:"cursor-pointer",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(h.Z,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:F.documents.organizationCert?F.documents.organizationCert.name:"คลิกเพื่อเลือกไฟล์"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PDF, JPG, PNG (ไม่เกิน 5MB)"})]})})]})]})]})}),"otp"===T&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto",children:(0,r.jsx)(d.Z,{className:"w-8 h-8 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"ยืนยันอีเมลของคุณ"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"เราได้ส่งรหัส OTP 6 หลักไปยัง"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-800",children:F.email})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v._,{htmlFor:"otp",className:"text-gray-700",children:"รหัส OTP *"}),(0,r.jsx)(y.I,{id:"otp",type:"text",placeholder:"กรอกรหัส 6 หลัก",value:L,onChange:e=>q(e.target.value.replace(/\D/g,"").slice(0,6)),className:"text-center text-lg tracking-widest",maxLength:6,required:!0})]}),(0,r.jsx)(f.z,{type:"button",variant:"link",onClick:Q,className:"text-pink-600 hover:text-pink-700",disabled:R,children:"ส่งรหัสใหม่"})]})}),(0,r.jsx)(f.z,{type:"submit",className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",disabled:R,children:R?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"กำลังดำเนินการ..."]}):(0,r.jsxs)(r.Fragment,{children:["info"===T&&(F.role,"ถัดไป"),"interests"===T&&"ส่ง OTP","documents"===T&&"ส่ง OTP","otp"===T&&"ยืนยันและสมัครสมาชิก"]})})]}),"info"===T&&(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["มีบัญชีอยู่แล้ว?"," ",(0,r.jsx)(f.z,{variant:"link",onClick:()=>e.push("/login"),className:"p-0 h-auto text-pink-600 hover:text-pink-700",children:"เข้าสู่ระบบ"})]})}),"interests"===T&&(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"\uD83D\uDCA1 คุณสามารถข้ามขั้นตอนนี้และเลือกความสนใจในภายหลังได้"})})]})]})]})})}},4738:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return l},a:function(){return o}});var r=a(7437),s=a(2265),n=a(3464);let i=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[a,l]=(0,s.useState)(null),[o,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("token");e?(n.Z.defaults.headers.common.Authorization="Bearer ".concat(e),n.Z.get("/api/auth/me").then(t=>{console.log("Fetched user data:",t.data.user),l({...t.data.user,token:e})}).catch(e=>{console.error("Failed to fetch user data:",e),localStorage.removeItem("token"),delete n.Z.defaults.headers.common.Authorization}).finally(()=>d(!1))):d(!1)},[]);let c=async(e,t)=>{d(!0);try{let a=await n.Z.post("/api/auth/login",{email:e,password:t}),r=a.data.token;if(!r)throw Error("Token not received");return localStorage.setItem("token",r),n.Z.defaults.headers.common.Authorization="Bearer ".concat(r),l({...a.data.user,token:r}),console.log("Login successful, user:",a.data.user),d(!1),!0}catch(e){return console.error("Login error:",e),d(!1),!1}},u=async e=>{d(!0);try{var t,a;let r=new FormData;r.append("email",e.email),r.append("password",e.password),r.append("firstName",e.firstName),r.append("lastName",e.lastName),r.append("phone",e.phone),r.append("role",e.role),e.organizationId&&r.append("organizationId",e.organizationId),e.newOrganizationName&&r.append("newOrganizationName",e.newOrganizationName),e.organizationType&&r.append("organizationType",e.organizationType),e.registrationNumber&&r.append("registrationNumber",e.registrationNumber),e.templeId&&r.append("templeId",e.templeId),e.interests&&r.append("interests",JSON.stringify(e.interests)),(null===(t=e.documents)||void 0===t?void 0:t.idCard)&&r.append("idCard",e.documents.idCard),(null===(a=e.documents)||void 0===a?void 0:a.organizationCert)&&r.append("organizationCert",e.documents.organizationCert);let s=await n.Z.post("/api/auth/register",r,{headers:{"Content-Type":"multipart/form-data"}}),i=s.data.token;if(!i)throw Error("Token not received");return localStorage.setItem("token",i),n.Z.defaults.headers.common.Authorization="Bearer ".concat(i),l({...s.data.user,token:i}),console.log("Register successful, user:",s.data.user),d(!1),!0}catch(e){return console.error("Register error:",e),d(!1),!1}},m=async e=>{d(!0);try{return await n.Z.post("/api/auth/send-otp",{email:e}),console.log("OTP sent to:",e),d(!1),!0}catch(e){return console.error("Send OTP error:",e),d(!1),!1}},p=async(e,t)=>{d(!0);try{let a=await n.Z.post("/api/auth/verify-otp",{email:e,otp:t});return console.log("OTP verification result:",a.data.success),d(!1),a.data.success}catch(e){return console.error("Verify OTP error:",e),d(!1),!1}};return(0,r.jsx)(i.Provider,{value:{user:a,login:c,register:u,sendOTP:m,verifyOTP:p,logout:()=>{l(null),localStorage.removeItem("token"),delete n.Z.defaults.headers.common.Authorization,console.log("User logged out")},setUser:l,isLoading:o},children:t})}function o(){let e=(0,s.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},5613:function(e,t,a){"use strict";a.d(t,{X:function(){return d},bZ:function(){return o}});var r=a(7437),s=a(2265),n=a(535),i=a(4508);let l=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,t)=>{let{className:a,variant:s,...n}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:s}),a),...n})});o.displayName="Alert",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})}).displayName="AlertTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...s})});d.displayName="AlertDescription"},2869:function(e,t,a){"use strict";a.d(t,{z:function(){return d}});var r=a(7437),s=a(2265),n=a(7053),i=a(535),l=a(4508);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:i,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,r.jsx)(u,{className:(0,l.cn)(o({variant:s,size:i,className:a})),ref:t,...c})});d.displayName="Button"},6070:function(e,t,a){"use strict";a.d(t,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},eW:function(){return u},ll:function(){return o}});var r=a(7437),s=a(2265),n=a(4508);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});i.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},1800:function(e,t,a){"use strict";a.d(t,{X:function(){return o}});var r=a(7437),s=a(2265),n=a(9270),i=a(401),l=a(4508);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.fC,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.jsx)(n.z$,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})})});o.displayName=n.fC.displayName},5186:function(e,t,a){"use strict";a.d(t,{I:function(){return i}});var r=a(7437),s=a(2265),n=a(4508);let i=s.forwardRef((e,t)=>{let{className:a,type:s,...i}=e;return(0,r.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},6815:function(e,t,a){"use strict";a.d(t,{_:function(){return d}});var r=a(7437),s=a(2265),n=a(6394),i=a(535),l=a(4508);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.f,{ref:t,className:(0,l.cn)(o(),a),...s})});d.displayName=n.f.displayName},2759:function(e,t,a){"use strict";a.d(t,{E:function(){return l}});var r=a(7437),s=a(2265),n=a(610),i=a(4508);let l=s.forwardRef((e,t)=>{let{className:a,value:s,...l}=e;return(0,r.jsx)(n.fC,{ref:t,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...l,children:(0,r.jsx)(n.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});l.displayName=n.fC.displayName},3647:function(e,t,a){"use strict";a.d(t,{Bw:function(){return g},Ph:function(){return c},Ql:function(){return h},i4:function(){return m},ki:function(){return u}});var r=a(7437),s=a(2265),n=a(3278),i=a(875),l=a(2135),o=a(401),d=a(4508);let c=n.fC;n.ZA;let u=n.B4,m=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(n.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[s,(0,r.jsx)(n.JO,{asChild:!0,children:(0,r.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.xz.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})});p.displayName=n.u_.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})});x.displayName=n.$G.displayName;let g=s.forwardRef((e,t)=>{let{className:a,children:s,position:i="popper",...l}=e;return(0,r.jsx)(n.h_,{children:(0,r.jsxs)(n.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...l,children:[(0,r.jsx)(p,{}),(0,r.jsx)(n.l_,{className:(0,d.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(x,{})]})})});g.displayName=n.VY.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=n.__.displayName;let h=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,r.jsxs)(n.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.wU,{children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(n.eT,{children:s})]})});h.displayName=n.ck.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=n.Z0.displayName},4508:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var r=a(1994),s=a(3335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[2582,3464,7514,2557,6252,2971,2117,1744],function(){return e(e.s=9227)}),_N_E=e.O()}]);