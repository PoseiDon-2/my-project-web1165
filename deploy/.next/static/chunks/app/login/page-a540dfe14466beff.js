(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{746:function(e,t,r){Promise.resolve().then(r.bind(r,6374))},6374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var a=r(7437),n=r(2265),s=r(9376),o=r(9345),i=r(6337),l=r(7769),d=r(2208),c=r(2869),u=r(6070),f=r(5186),m=r(6815),p=r(5613),h=r(4738);function g(){let e=(0,s.useRouter)(),{login:t,isLoading:r,user:g}=(0,h.a)(),[x,v]=(0,n.useState)({email:"",password:""}),[y,b]=(0,n.useState)(!1),[N,w]=(0,n.useState)("");(0,n.useEffect)(()=>{g&&e.push("/")},[g,e]);let j=async e=>{if(e.preventDefault(),w(""),!x.email||!x.password){w("กรุณากรอกอีเมลและรหัสผ่าน");return}try{await t(x.email,x.password)||w("อีเมลหรือรหัสผ่านไม่ถูกต้อง")}catch(e){console.error("Login failed:",e),w("เกิดข้อผิดพลาดในการเข้าสู่ระบบ")}},k=e=>{let{name:t,value:r}=e.target;v({...x,[t]:r})};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"\uD83D\uDC9D DonateSwipe"}),(0,a.jsx)("p",{className:"text-gray-600",children:"เข้าสู่ระบบเพื่อเริ่มช่วยเหลือผู้อื่น"})]}),(0,a.jsxs)(u.Zb,{className:"shadow-xl border-0",children:[(0,a.jsx)(u.Ol,{className:"text-center",children:(0,a.jsx)(u.ll,{className:"text-2xl font-bold text-gray-800",children:"เข้าสู่ระบบ"})}),(0,a.jsxs)(u.aY,{className:"space-y-6",children:[(0,a.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[N&&(0,a.jsx)(p.bZ,{className:"border-red-200 bg-red-50",children:(0,a.jsx)(p.X,{className:"text-red-700",children:N})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m._,{htmlFor:"email",className:"text-gray-700",children:"อีเมล"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)(f.I,{id:"email",name:"email",type:"email",placeholder:"กรอกอีเมลของคุณ",value:x.email,onChange:k,className:"pl-10",required:!0,disabled:r})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m._,{htmlFor:"password",className:"text-gray-700",children:"รหัสผ่าน"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)(f.I,{id:"password",name:"password",type:y?"text":"password",placeholder:"กรอกรหัสผ่านของคุณ",value:x.password,onChange:k,className:"pl-10 pr-10",required:!0,disabled:r}),(0,a.jsx)(c.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0",onClick:()=>b(!y),disabled:r,children:y?(0,a.jsx)(l.Z,{className:"w-4 h-4"}):(0,a.jsx)(d.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)(c.z,{variant:"link",onClick:()=>e.push("/forgot-password"),className:"p-0 h-auto text-pink-600 hover:text-pink-700 text-sm",disabled:r,children:"ลืมรหัสผ่าน?"})}),(0,a.jsx)(c.z,{type:"submit",className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",disabled:r,children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"กำลังเข้าสู่ระบบ..."]}):"เข้าสู่ระบบ"})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["ยังไม่มีบัญชี?"," ",(0,a.jsx)(c.z,{variant:"link",onClick:()=>e.push("/register"),className:"p-0 h-auto text-pink-600 hover:text-pink-700",disabled:r,children:"สมัครสมาชิก"})]})})]})]})]})})}},4738:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return i},a:function(){return l}});var a=r(7437),n=r(2265),s=r(3464);let o=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[l,d]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=localStorage.getItem("token");e?(s.Z.defaults.headers.common.Authorization="Bearer ".concat(e),s.Z.get("/api/auth/me").then(t=>{console.log("Fetched user data:",t.data.user),i({...t.data.user,token:e})}).catch(e=>{console.error("Failed to fetch user data:",e),localStorage.removeItem("token"),delete s.Z.defaults.headers.common.Authorization}).finally(()=>d(!1))):d(!1)},[]);let c=async(e,t)=>{d(!0);try{let r=await s.Z.post("/api/auth/login",{email:e,password:t}),a=r.data.token;if(!a)throw Error("Token not received");return localStorage.setItem("token",a),s.Z.defaults.headers.common.Authorization="Bearer ".concat(a),i({...r.data.user,token:a}),console.log("Login successful, user:",r.data.user),d(!1),!0}catch(e){return console.error("Login error:",e),d(!1),!1}},u=async e=>{d(!0);try{var t,r;let a=new FormData;a.append("email",e.email),a.append("password",e.password),a.append("firstName",e.firstName),a.append("lastName",e.lastName),a.append("phone",e.phone),a.append("role",e.role),e.organizationId&&a.append("organizationId",e.organizationId),e.newOrganizationName&&a.append("newOrganizationName",e.newOrganizationName),e.organizationType&&a.append("organizationType",e.organizationType),e.registrationNumber&&a.append("registrationNumber",e.registrationNumber),e.templeId&&a.append("templeId",e.templeId),e.interests&&a.append("interests",JSON.stringify(e.interests)),(null===(t=e.documents)||void 0===t?void 0:t.idCard)&&a.append("idCard",e.documents.idCard),(null===(r=e.documents)||void 0===r?void 0:r.organizationCert)&&a.append("organizationCert",e.documents.organizationCert);let n=await s.Z.post("/api/auth/register",a,{headers:{"Content-Type":"multipart/form-data"}}),o=n.data.token;if(!o)throw Error("Token not received");return localStorage.setItem("token",o),s.Z.defaults.headers.common.Authorization="Bearer ".concat(o),i({...n.data.user,token:o}),console.log("Register successful, user:",n.data.user),d(!1),!0}catch(e){return console.error("Register error:",e),d(!1),!1}},f=async e=>{d(!0);try{return await s.Z.post("/api/auth/send-otp",{email:e}),console.log("OTP sent to:",e),d(!1),!0}catch(e){return console.error("Send OTP error:",e),d(!1),!1}},m=async(e,t)=>{d(!0);try{let r=await s.Z.post("/api/auth/verify-otp",{email:e,otp:t});return console.log("OTP verification result:",r.data.success),d(!1),r.data.success}catch(e){return console.error("Verify OTP error:",e),d(!1),!1}};return(0,a.jsx)(o.Provider,{value:{user:r,login:c,register:u,sendOTP:f,verifyOTP:m,logout:()=>{i(null),localStorage.removeItem("token"),delete s.Z.defaults.headers.common.Authorization,console.log("User logged out")},setUser:i,isLoading:l},children:t})}function l(){let e=(0,n.useContext)(o);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},5613:function(e,t,r){"use strict";r.d(t,{X:function(){return d},bZ:function(){return l}});var a=r(7437),n=r(2265),s=r(535),o=r(4508);let i=(0,s.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=n.forwardRef((e,t)=>{let{className:r,variant:n,...s}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,o.cn)(i({variant:n}),r),...s})});l.displayName="Alert",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("h5",{ref:t,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",r),...n})}).displayName="AlertTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",r),...n})});d.displayName="AlertDescription"},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var a=r(7437),n=r(2265),s=r(7053),o=r(535),i=r(4508);let l=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:o,asChild:d=!1,...c}=e,u=d?s.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:n,size:o,className:r})),ref:t,...c})});d.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return o},aY:function(){return c},eW:function(){return u},ll:function(){return l}});var a=r(7437),n=r(2265),s=r(4508);let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});o.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...n})});i.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});l.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return o}});var a=r(7437),n=r(2265),s=r(4508);let o=n.forwardRef((e,t)=>{let{className:r,type:n,...o}=e;return(0,a.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...o})});o.displayName="Input"},6815:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var a=r(7437),n=r(2265),s=r(6394),o=r(535),i=r(4508);let l=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.f,{ref:t,className:(0,i.cn)(l(),r),...n})});d.displayName=s.f.displayName},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var a=r(1994),n=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}},7769:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},2208:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6337:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},9345:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},6394:function(e,t,r){"use strict";r.d(t,{f:function(){return i}});var a=r(2265),n=r(6840),s=r(7437),o=a.forwardRef((e,t)=>(0,s.jsx)(n.WV.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));o.displayName="Label";var i=o},6840:function(e,t,r){"use strict";r.d(t,{WV:function(){return i},jH:function(){return l}});var a=r(2265),n=r(4887),s=r(7053),o=r(7437),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=a.forwardRef((e,r)=>{let{asChild:a,...n}=e,i=a?s.g7:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(i,{...n,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function l(e,t){e&&n.flushSync(()=>e.dispatchEvent(t))}}},function(e){e.O(0,[2582,3464,2971,2117,1744],function(){return e(e.s=746)}),_N_E=e.O()}]);