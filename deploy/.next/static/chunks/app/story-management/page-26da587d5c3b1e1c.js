(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3006],{6173:function(e,t,r){Promise.resolve().then(r.bind(r,8714))},8714:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var s=r(7437),a=r(2265),n=r(9376),i=r(2660),l=r(9397),o=r(6215),c=r(2208),d=r(5805),u=r(5868),m=r(8930),h=r(1047),p=r(2869),x=r(6070),g=r(5974),f=r(4738);let v=[{id:1,title:"ช่วยเหลือครอบครัวที่ประสบอุทกภัย",organizer:"สมชาย ใจดี",stories:[{id:1,donationRequestId:1,title:"เริ่มซ่อมแซมบ้าน",content:"วันนี้ได้เริ่มซ่อมแซมหลังคาและผนังที่เสียหายจากน้ำท่วมแล้วครับ ขอบคุณทุกท่านที่ให้ความช่วยเหลือ",type:"progress",image:"/placeholder.svg?height=600&width=400",timestamp:"2024-01-15T10:00:00Z",views:234,likes:45,duration:5},{id:2,donationRequestId:1,title:"ความคืบหน้า 50%",content:"ระดมทุนได้ครึ่งหนึ่งแล้ว! ขอบคุณผู้บริจาคทุกท่าน เรากำลังใกล้เป้าหมายแล้ว",type:"milestone",image:"/placeholder.svg?height=600&width=400",timestamp:"2024-01-14T15:30:00Z",views:189,likes:38,duration:4},{id:3,donationRequestId:1,title:"ขอบคุณผู้บริจาค",content:"ขอบพระคุณทุกท่านที่ให้ความช่วยเหลือครอบครัวเรา ความช่วยเหลือของทุกท่านมีความหมายมากสำหรับเรา",type:"thank_you",image:"/placeholder.svg?height=600&width=400",timestamp:"2024-01-13T09:15:00Z",views:156,likes:52,duration:6}]},{id:2,title:"สร้างห้องสมุดให้โรงเรียนชนบท",organizer:"โรงเรียนบ้านดอนตาล",stories:[{id:4,donationRequestId:2,title:"เริ่มก่อสร้าง",content:"เริ่มก่อสร้างห้องสมุดแล้ว! เด็กๆ ตื่นเต้นมาก รอไม่ไหวที่จะได้อ่านหนังสือใหม่ๆ",type:"progress",image:"/placeholder.svg?height=600&width=400",timestamp:"2024-01-12T08:00:00Z",views:98,likes:23,duration:5}]}];function y(){let e=(0,n.useRouter)(),{user:t}=(0,f.a)(),[r,y]=(0,a.useState)(null);if((0,a.useEffect)(()=>{t&&"ORGANIZER"===t.role||e.push("/")},[t,e]),!t||"ORGANIZER"!==t.role)return null;let j=e=>({progress:"bg-blue-100 text-blue-700",milestone:"bg-purple-100 text-purple-700",thank_you:"bg-green-100 text-green-700",completion:"bg-orange-100 text-orange-700"})[e]||"bg-gray-100 text-gray-700",b=e=>({progress:"ความคืบหน้า",milestone:"เหตุการณ์สำคัญ",thank_you:"ขอบคุณ",completion:"เสร็จสิ้น"})[e]||e,N=e=>{let t=new Date,r=new Date(e),s=Math.floor((t.getTime()-r.getTime())/36e5);return s<1?"เมื่อสักครู่":s<24?"".concat(s," ชั่วโมงที่แล้ว"):"".concat(Math.floor(s/24)," วันที่แล้ว")},k=v.reduce((e,t)=>e+t.stories.length,0),w=v.reduce((e,t)=>e+t.stories.reduce((e,t)=>e+t.views,0),0),Z=v.reduce((e,t)=>e+t.stories.reduce((e,t)=>e+t.likes,0),0),z=r?v.filter(e=>e.id===r):v;return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50",children:[(0,s.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(p.z,{variant:"ghost",size:"sm",onClick:()=>e.push("/organizer-dashboard"),className:"hover:bg-pink-50",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"กลับ"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"จัดการ Stories"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"สร้างและจัดการ Stories สำหรับคำขอบริจาคของคุณ"})]})]}),(0,s.jsxs)(p.z,{onClick:()=>e.push("/create-story"),className:"bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",children:[(0,s.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"สร้าง Story ใหม่"]})]})})}),(0,s.jsxs)("div",{className:"max-w-6xl mx-auto p-4",children:[(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-4 mb-8",children:[(0,s.jsx)(x.Zb,{children:(0,s.jsx)(x.aY,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Stories ทั้งหมด"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:k})]}),(0,s.jsx)(o.Z,{className:"w-8 h-8 text-purple-500"})]})})}),(0,s.jsx)(x.Zb,{children:(0,s.jsx)(x.aY,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"การดูรวม"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:w.toLocaleString()})]}),(0,s.jsx)(c.Z,{className:"w-8 h-8 text-blue-500"})]})})}),(0,s.jsx)(x.Zb,{children:(0,s.jsx)(x.aY,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"ถูกใจรวม"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-pink-600",children:Z})]}),(0,s.jsx)(d.Z,{className:"w-8 h-8 text-pink-500"})]})})}),(0,s.jsx)(x.Zb,{children:(0,s.jsx)(x.aY,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"อัตราการมีส่วนร่วม"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[w>0?Math.round(Z/w*100):0,"%"]})]}),(0,s.jsx)(o.Z,{className:"w-8 h-8 text-green-500"})]})})})]}),(0,s.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(p.z,{variant:null===r?"default":"outline",size:"sm",onClick:()=>y(null),className:null===r?"bg-pink-500 hover:bg-pink-600":"bg-transparent",children:"ทั้งหมด"}),v.map(e=>(0,s.jsxs)(p.z,{variant:r===e.id?"default":"outline",size:"sm",onClick:()=>y(e.id),className:r===e.id?"bg-pink-500 hover:bg-pink-600":"bg-transparent",children:[e.title.length>20?"".concat(e.title.substring(0,20),"..."):e.title,(0,s.jsx)(g.C,{variant:"secondary",className:"ml-2",children:e.stories.length})]},e.id))]})}),(0,s.jsx)("div",{className:"space-y-6",children:z.map(t=>(0,s.jsxs)(x.Zb,{children:[(0,s.jsx)(x.Ol,{children:(0,s.jsxs)(x.ll,{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:t.title}),(0,s.jsxs)(g.C,{variant:"outline",children:[t.stories.length," Stories"]})]})}),(0,s.jsx)(x.aY,{children:t.stories.length>0?(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.stories.map(e=>(0,s.jsxs)(x.Zb,{className:"overflow-hidden",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.title,className:"w-full h-32 object-cover"}),(0,s.jsx)("div",{className:"absolute top-2 left-2",children:(0,s.jsx)(g.C,{className:j(e.type),children:b(e.type)})}),(0,s.jsxs)("div",{className:"absolute top-2 right-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:[e.duration,"s"]})]}),(0,s.jsx)(x.aY,{className:"p-4",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-gray-800 line-clamp-1",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 mt-1",children:e.content})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,s.jsx)("span",{children:N(e.timestamp)}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(c.Z,{className:"w-3 h-3"}),e.views]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(d.Z,{className:"w-3 h-3"}),e.likes]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,s.jsxs)(p.z,{size:"sm",variant:"outline",className:"flex-1 bg-transparent",children:[(0,s.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),"ดู"]}),(0,s.jsxs)(p.z,{size:"sm",variant:"outline",className:"flex-1 bg-transparent",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),"แก้ไข"]}),(0,s.jsx)(p.z,{size:"sm",variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50 bg-transparent",children:(0,s.jsx)(m.Z,{className:"w-4 h-4"})})]})]})})]},e.id))}):(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(h.Z,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,s.jsx)("p",{children:"ยังไม่มี Stories สำหรับคำขอนี้"}),(0,s.jsx)(p.z,{onClick:()=>e.push("/create-story"),className:"mt-4 bg-pink-500 hover:bg-pink-600",children:"สร้าง Story แรก"})]})})]},t.id))}),0===z.length&&(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsx)(h.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-600 mb-2",children:"ยังไม่มี Stories"}),(0,s.jsx)("p",{className:"text-gray-500 mb-6",children:"เริ่มสร้าง Story แรกเพื่อแชร์ความคืบหน้าให้ผู้บริจาคทราบ"}),(0,s.jsxs)(p.z,{onClick:()=>e.push("/create-story"),className:"bg-pink-500 hover:bg-pink-600",children:[(0,s.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"สร้าง Story ใหม่"]})]})]})]})}},4738:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return l},a:function(){return o}});var s=r(7437),a=r(2265),n=r(3464);let i=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=localStorage.getItem("token");e?(n.Z.defaults.headers.common.Authorization="Bearer ".concat(e),n.Z.get("/api/auth/me").then(t=>{console.log("Fetched user data:",t.data.user),l({...t.data.user,token:e})}).catch(e=>{console.error("Failed to fetch user data:",e),localStorage.removeItem("token"),delete n.Z.defaults.headers.common.Authorization}).finally(()=>c(!1))):c(!1)},[]);let d=async(e,t)=>{c(!0);try{let r=await n.Z.post("/api/auth/login",{email:e,password:t}),s=r.data.token;if(!s)throw Error("Token not received");return localStorage.setItem("token",s),n.Z.defaults.headers.common.Authorization="Bearer ".concat(s),l({...r.data.user,token:s}),console.log("Login successful, user:",r.data.user),c(!1),!0}catch(e){return console.error("Login error:",e),c(!1),!1}},u=async e=>{c(!0);try{var t,r;let s=new FormData;s.append("email",e.email),s.append("password",e.password),s.append("firstName",e.firstName),s.append("lastName",e.lastName),s.append("phone",e.phone),s.append("role",e.role),e.organizationId&&s.append("organizationId",e.organizationId),e.newOrganizationName&&s.append("newOrganizationName",e.newOrganizationName),e.organizationType&&s.append("organizationType",e.organizationType),e.registrationNumber&&s.append("registrationNumber",e.registrationNumber),e.templeId&&s.append("templeId",e.templeId),e.interests&&s.append("interests",JSON.stringify(e.interests)),(null===(t=e.documents)||void 0===t?void 0:t.idCard)&&s.append("idCard",e.documents.idCard),(null===(r=e.documents)||void 0===r?void 0:r.organizationCert)&&s.append("organizationCert",e.documents.organizationCert);let a=await n.Z.post("/api/auth/register",s,{headers:{"Content-Type":"multipart/form-data"}}),i=a.data.token;if(!i)throw Error("Token not received");return localStorage.setItem("token",i),n.Z.defaults.headers.common.Authorization="Bearer ".concat(i),l({...a.data.user,token:i}),console.log("Register successful, user:",a.data.user),c(!1),!0}catch(e){return console.error("Register error:",e),c(!1),!1}},m=async e=>{c(!0);try{return await n.Z.post("/api/auth/send-otp",{email:e}),console.log("OTP sent to:",e),c(!1),!0}catch(e){return console.error("Send OTP error:",e),c(!1),!1}},h=async(e,t)=>{c(!0);try{let r=await n.Z.post("/api/auth/verify-otp",{email:e,otp:t});return console.log("OTP verification result:",r.data.success),c(!1),r.data.success}catch(e){return console.error("Verify OTP error:",e),c(!1),!1}};return(0,s.jsx)(i.Provider,{value:{user:r,login:d,register:u,sendOTP:m,verifyOTP:h,logout:()=>{l(null),localStorage.removeItem("token"),delete n.Z.defaults.headers.common.Authorization,console.log("User logged out")},setUser:l,isLoading:o},children:t})}function o(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var s=r(7437);r(2265);var a=r(535),n=r(4508);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:r}),t),...a})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var s=r(7437),a=r(2265),n=r(7053),i=r(535),l=r(4508);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:r})),ref:t,...d})});c.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return o}});var s=r(7437),a=r(2265),n=r(4508);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var s=r(1994),a=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},6215:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},2208:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9397:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5868:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},8930:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[2582,3464,2971,2117,1744],function(){return e(e.s=6173)}),_N_E=e.O()}]);