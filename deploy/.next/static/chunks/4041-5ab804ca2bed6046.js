"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4041],{777:function(e,s,a){a.d(s,{Z:function(){return b}});var t=a(7437),l=a(2265),r=a(9376),n=a(2660),i=a(2489),c=a(7404),d=a(8226),o=a(3388),m=a(401),x=a(8867),h=a(2869),u=a(6070),p=a(5186),j=a(6815),g=a(6818),N=a(6973),f=a(5271),v=a(4738),y=a(7992);function b(e){let{isOpen:s,onClose:a,donation:b}=e,[w,k]=(0,l.useState)("method"),[C,S]=(0,l.useState)("qr"),[D,I]=(0,l.useState)(""),[P,F]=(0,l.useState)(""),[_,E]=(0,l.useState)(""),[T,O]=(0,l.useState)(!1),[z,R]=(0,l.useState)(!1),[A,q]=(0,l.useState)(!1),[Q,Z]=(0,l.useState)(0),{user:L}=(0,v.a)(),M=(0,r.useRouter)(),[V,J]=(0,l.useState)(""),[H,U]=(0,l.useState)(""),[Y,B]=(0,l.useState)(""),[X,G]=(0,l.useState)(""),$=e=>new Intl.NumberFormat("th-TH").format(Number(e)),K=e=>{navigator.clipboard.writeText(e),R(!0),setTimeout(()=>R(!1),2e3)},W=(0,l.useCallback)(e=>{I(e),F("")},[]),ee=(0,l.useCallback)(e=>{F(e),I(e)},[]),es=(0,l.useCallback)(async()=>{if(!L){(0,y.Am)({title:"ข้อผิดพลาด",description:"กรุณาเข้าสู่ระบบก่อนบริจาค"});return}if(q(!0),await new Promise(e=>setTimeout(e,3e3)),D){let e=Number(D),s=N.g.calculateDonationPoints(e,"money");await N.g.addPoints(L.id,"donation",s,"Donation to ".concat(b.title," (฿").concat(e,")"),b.id),Z(s);let a=f.X.createReceipt({donationId:"donation_".concat(Date.now()),requestId:b.id,requestTitle:b.title,donorId:L.id,donorName:T?void 0:"".concat(L.firstName," ").concat(L.lastName),amount:e,type:"money",paymentMethod:"qr"===C?"PromptPay":"credit"===C?"Credit Card":"Bank Transfer",transactionId:"TXN_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,9)),message:_,isAnonymous:T,pointsEarned:s,attachments:void 0});try{let t={id:a.donationId,userId:L.id,amount:e,requestId:b.id,requestTitle:b.title,type:"money",date:new Date().toISOString(),status:"completed",paymentMethod:"qr"===C?"PromptPay":"credit"===C?"Credit Card":"Bank Transfer",pointsEarned:s},l=L.id,r=JSON.parse(localStorage.getItem("user_donations_".concat(l))||"[]");r.push(t),localStorage.setItem("user_donations_".concat(l),JSON.stringify(r));let n=JSON.parse(localStorage.getItem("users")||"[]"),i=n.findIndex(e=>e.id===l);-1!==i&&(n[i].totalDonated=(n[i].totalDonated||0)+e,n[i].donationCount=(n[i].donationCount||0)+1,localStorage.setItem("users",JSON.stringify(n)))}catch(e){console.warn("LocalStorage unavailable (e.g., incognito mode):",e)}(0,y.Am)({title:"ได้รับ ".concat(s," คะแนน!"),description:"คุณได้รับคะแนนจากการบริจาค ฿".concat($(D))})}q(!1),k("success")},[L,D,b,C,T,_]),ea=(0,l.useCallback)(()=>{k("method"),S("qr"),I(""),F(""),E(""),O(!1),J(""),U(""),B(""),G(""),q(!1),Z(0)},[]),et=(0,l.useCallback)(()=>{ea(),a()},[a,ea]),el=(0,l.useCallback)(()=>{et(),M.push("/rewards")},[et,M]);return s?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)(u.Zb,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(u.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["method"!==w&&"success"!==w&&(0,t.jsx)(h.z,{variant:"ghost",size:"sm",onClick:()=>{"amount"===w?k("method"):"payment"===w&&k("amount")},children:(0,t.jsx)(n.Z,{className:"w-4 h-4"})}),(0,t.jsxs)(u.ll,{className:"text-lg",children:["method"===w&&"เลือกวิธีการบริจาค","amount"===w&&"ระบุจำนวนเงิน","payment"===w&&"ชำระเงิน","success"===w&&"บริจาคสำเร็จ"]})]}),(0,t.jsx)(h.z,{variant:"ghost",size:"sm",onClick:et,children:(0,t.jsx)(i.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)(u.aY,{className:"space-y-4",children:["method"===w&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-gray-800 mb-2",children:"บริจาคให้"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:b.title})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"เลือกวิธีการชำระเงิน"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("button",{className:"w-full p-4 border rounded-lg text-left transition-all ".concat("qr"===C?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>S("qr"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(c.Z,{className:"w-8 h-8 text-blue-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"QR Code PromptPay"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"สแกน QR Code เพื่อบริจาค"})]})]})}),(0,t.jsx)("button",{className:"w-full p-4 border rounded-lg text-left transition-all ".concat("credit"===C?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"),onClick:()=>S("credit"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(d.Z,{className:"w-8 h-8 text-purple-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"บัตรเครดิต/เดบิต"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"ชำระผ่านบัตรเครดิตหรือเดบิต"})]})]})}),(0,t.jsx)("button",{className:"w-full p-4 border rounded-lg text-left transition-all ".concat("bank"===C?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"),onClick:()=>S("bank"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(o.Z,{className:"w-8 h-8 text-green-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"โอนเงินผ่านธนาคาร"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"โอนเงินผ่านแอปธนาคาร"})]})]})})]})]}),(0,t.jsx)(h.z,{className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",onClick:()=>k("amount"),children:"ถัดไป"})]}),"amount"===w&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"เลือกจำนวนเงิน"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["100","500","1000","2000","5000"].map(e=>(0,t.jsxs)(h.z,{variant:D===e?"default":"outline",className:D===e?"bg-pink-500 hover:bg-pink-600":"",onClick:()=>W(e),children:["฿",$(e)]},e))}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j._,{htmlFor:"customAmount",children:"หรือระบุจำนวนเงินเอง"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"฿"}),(0,t.jsx)(p.I,{id:"customAmount",type:"number",placeholder:"0",className:"pl-8",value:P,onChange:e=>ee(e.target.value),min:"1"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j._,{htmlFor:"message",children:"ข้อความให้กำลังใจ (ไม่บังคับ)"}),(0,t.jsx)(g.g,{id:"message",placeholder:"เขียนข้อความให้กำลังใจ...",rows:3,value:_,onChange:e=>E(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"anonymous",checked:T,onChange:e=>O(e.target.checked),className:"rounded"}),(0,t.jsx)(j._,{htmlFor:"anonymous",className:"text-sm",children:"บริจาคแบบไม่ระบุชื่อ"})]}),D&&Number(D)>0&&(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"จำนวนที่บริจาค"}),(0,t.jsxs)("span",{className:"font-bold text-lg",children:["฿",$(D)]})]})}),(0,t.jsxs)(h.z,{className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",onClick:()=>k("payment"),disabled:!D||0>=Number(D),children:["ชำระเงิน ฿",D?$(D):"0"]})]}),"payment"===w&&(0,t.jsxs)("div",{className:"space-y-4",children:["qr"===C&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg border inline-block",children:(0,t.jsx)("img",{src:"/placeholder.svg?height=200&width=200&text=QR+Code+".concat(D,"+THB")||"/placeholder.svg",alt:"QR Code",className:"w-48 h-48 mx-auto"})}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"สแกน QR Code ด้วยแอปธนาคารของคุณ"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"PromptPay ID"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-mono",children:b.paymentMethods.promptpay}),(0,t.jsx)(h.z,{size:"sm",variant:"ghost",onClick:()=>K(b.paymentMethods.promptpay),children:z?(0,t.jsx)(m.Z,{className:"w-4 h-4"}):(0,t.jsx)(x.Z,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"จำนวนเงิน"}),(0,t.jsxs)("span",{className:"font-bold",children:["฿",$(D)]})]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm text-blue-800",children:(0,t.jsx)("strong",{children:"วิธีการชำระเงิน:"})}),(0,t.jsxs)("ol",{className:"text-sm text-blue-700 mt-1 space-y-1",children:[(0,t.jsx)("li",{children:"1. เปิดแอปธนาคารของคุณ"}),(0,t.jsx)("li",{children:"2. เลือกสแกน QR Code"}),(0,t.jsx)("li",{children:"3. สแกน QR Code ด้านบน"}),(0,t.jsx)("li",{children:"4. ยืนยันการชำระเงิน"})]})]}),(0,t.jsx)(h.z,{className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",onClick:es,disabled:A,children:A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"กำลังตรวจสอบการชำระเงิน..."]}):"ฉันชำระเงินแล้ว"})]}),"credit"===C&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j._,{htmlFor:"cardNumber",children:"หมายเลขบัตร"}),(0,t.jsx)(p.I,{id:"cardNumber",placeholder:"1234 5678 9012 3456",value:V,onChange:e=>J(e.target.value),maxLength:19})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j._,{htmlFor:"expiryDate",children:"วันหมดอายุ"}),(0,t.jsx)(p.I,{id:"expiryDate",placeholder:"MM/YY",value:H,onChange:e=>U(e.target.value),maxLength:5})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j._,{htmlFor:"cvv",children:"CVV"}),(0,t.jsx)(p.I,{id:"cvv",placeholder:"123",value:Y,onChange:e=>B(e.target.value),maxLength:4})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j._,{htmlFor:"cardName",children:"ชื่อบนบัตร"}),(0,t.jsx)(p.I,{id:"cardName",placeholder:"JOHN DOE",value:X,onChange:e=>G(e.target.value.toUpperCase())})]})]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"จำนวนที่ชำระ"}),(0,t.jsxs)("span",{className:"font-bold text-lg",children:["฿",$(D)]})]})}),(0,t.jsx)(h.z,{className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",onClick:es,disabled:A||!V||!H||!Y||!X,children:A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"กำลังประมวลผล..."]}):"ชำระเงิน ฿".concat($(D))})]}),"bank"===C&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"ข้อมูลการโอนเงิน"}),(0,t.jsxs)("div",{className:"space-y-2 p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ธนาคาร"}),(0,t.jsx)("span",{className:"font-medium",children:b.paymentMethods.bankAccount.bank})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"เลขที่บัญชี"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-mono",children:b.paymentMethods.bankAccount.accountNumber}),(0,t.jsx)(h.z,{size:"sm",variant:"ghost",onClick:()=>K(b.paymentMethods.bankAccount.accountNumber),children:z?(0,t.jsx)(m.Z,{className:"w-4 h-4"}):(0,t.jsx)(x.Z,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ชื่อบัญชี"}),(0,t.jsx)("span",{className:"font-medium",children:b.paymentMethods.bankAccount.accountName})]}),(0,t.jsxs)("div",{className:"flex justify-between border-t pt-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"จำนวนเงิน"}),(0,t.jsxs)("span",{className:"font-bold text-lg",children:["฿",$(D)]})]})]})]}),(0,t.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm text-green-800",children:(0,t.jsx)("strong",{children:"วิธีการโอนเงิน:"})}),(0,t.jsxs)("ol",{className:"text-sm text-green-700 mt-1 space-y-1",children:[(0,t.jsx)("li",{children:"1. เปิดแอปธนาคารของคุณ"}),(0,t.jsx)("li",{children:"2. เลือกโอนเงิน"}),(0,t.jsx)("li",{children:"3. กรอกข้อมูลบัญชีปลายทาง"}),(0,t.jsx)("li",{children:"4. ระบุจำนวนเงินที่ต้องการโอน"}),(0,t.jsx)("li",{children:"5. ยืนยันการโอนเงิน"})]})]}),(0,t.jsx)(h.z,{className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",onClick:es,disabled:A,children:A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"กำลังตรวจสอบการโอนเงิน..."]}):"ฉันโอนเงินแล้ว"})]})]}),"success"===w&&(0,t.jsxs)("div",{className:"space-y-4 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:(0,t.jsx)(m.Z,{className:"w-8 h-8 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"บริจาคสำเร็จ!"}),(0,t.jsx)("p",{className:"text-gray-600",children:"ขอบคุณสำหรับความใจดีของคุณ"})]}),Q>0&&(0,t.jsxs)("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"\uD83E\uDE99"}),(0,t.jsxs)("span",{className:"text-xl font-bold text-yellow-700",children:["+",Q," คะแนน!"]})]}),(0,t.jsx)("p",{className:"text-sm text-yellow-600",children:"คุณได้รับคะแนนจากการบริจาค สามารถนำไปแลกรางวัลได้"})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"จำนวนที่บริจาค"}),(0,t.jsxs)("span",{className:"font-bold",children:["฿",$(D)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"วิธีการชำระ"}),(0,t.jsxs)("span",{className:"text-sm",children:["qr"===C&&"QR Code PromptPay","credit"===C&&"บัตรเครดิต/เดบิต","bank"===C&&"โอนเงินผ่านธนาคาร"]})]}),Q>0&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"คะแนนที่ได้รับ"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-yellow-600",children:["+",Q," คะแนน"]})]}),_&&(0,t.jsxs)("div",{className:"pt-2 border-t",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ข้อความ:"}),(0,t.jsxs)("p",{className:"text-sm italic",children:['"',_,'"']})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.z,{className:"w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600",onClick:et,children:"เสร็จสิ้น"}),Q>0&&(0,t.jsx)(h.z,{variant:"outline",className:"w-full bg-transparent",onClick:el,children:"\uD83C\uDF81 ไปดูรางวัลที่แลกได้"}),(0,t.jsx)(h.z,{variant:"outline",className:"w-full bg-transparent",children:"แชร์การบริจาค"})]}),(0,t.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83C\uDF89 การบริจาคของคุณจะช่วยให้โครงการนี้ประสบความสำเร็จ",(0,t.jsx)("br",{}),"คุณจะได้รับอีเมลยืนยันการบริจาคในอีกสักครู่"]})})]})]})]})}):null}},3535:function(e,s,a){a.d(s,{Z:function(){return y}});var t=a(7437),l=a(2265),r=a(2489),n=a(340),i=a(3774),c=a(401),d=a(2869),o=a(6070),m=a(5186),x=a(6815),h=a(6818),u=a(3647),p=a(1800),j=a(6973),g=a(5271),N=a(4738),f=a(7992),v=a(9376);function y(e){let{isOpen:s,onClose:a,donation:y}=e,[b,w]=(0,l.useState)("delivery"),[k,C]=(0,l.useState)("send-to-address"),[S,D]=(0,l.useState)(""),[I,P]=(0,l.useState)(""),[F,_]=(0,l.useState)(""),[E,T]=(0,l.useState)(""),[O,z]=(0,l.useState)(""),[R,A]=(0,l.useState)(""),[q,Q]=(0,l.useState)(!1),[Z,L]=(0,l.useState)(!1),[M,V]=(0,l.useState)(""),[J,H]=(0,l.useState)(0),U=(0,v.useRouter)(),{user:Y}=(0,N.a)(),B=async()=>{if(L(!0),await new Promise(e=>setTimeout(e,2e3)),Y){let e=j.g.calculateDonationPoints(1,"item");j.g.addPoints(Y.id,"donation",e,"Item donation to ".concat(y.title," (").concat(y.itemsNeeded,")"),y.id.toString()),H(e);let s={id:g.X.createReceipt({donationId:"donation_".concat(Date.now()),requestId:y.id.toString(),requestTitle:y.title,donorId:Y.id,donorName:q?void 0:F||"".concat(Y.firstName," ").concat(Y.lastName),type:"items",items:[{name:y.itemsNeeded,quantity:1}],deliveryMethod:k,trackingNumber:M||void 0,message:R,isAnonymous:q,pointsEarned:e,attachments:void 0}).donationId,userId:Y.id,requestId:y.id.toString(),requestTitle:y.title,type:"items",date:new Date().toISOString(),status:"pending",deliveryMethod:k,deliveryDate:S,deliveryTime:I,trackingNumber:M||void 0,items:[{name:y.itemsNeeded,quantity:1,status:"pending"}],pointsEarned:e},a=JSON.parse(localStorage.getItem("user_donations_".concat(Y.id))||"[]");a.push(s),localStorage.setItem("user_donations_".concat(Y.id),JSON.stringify(a));let t=JSON.parse(localStorage.getItem("users")||"[]"),l=t.findIndex(e=>e.id===Y.id);-1!==l&&(t[l].donationCount=(t[l].donationCount||0)+1,localStorage.setItem("users",JSON.stringify(t))),(0,f.Am)({title:"ได้รับ ".concat(e," คะแนน!"),description:"คุณได้รับคะแนนจากการบริจาคสิ่งของ"})}L(!1),w("success")},X=()=>{w("delivery"),C("send-to-address"),D(""),P(""),_(""),T(""),z(""),A(""),Q(!1),L(!1),V(""),H(0)},G=()=>{X(),a()},$=e=>({"send-to-address":"ส่งตามที่อยู่","drop-off":"นำไปส่งถึงที่"})[e];return s?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)(o.Zb,{className:"w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(o.ll,{className:"text-lg",children:["delivery"===b&&"ยืนยันการบริจาคสิ่งของ","success"===b&&"บริจาคสำเร็จ"]})}),(0,t.jsx)(d.z,{variant:"ghost",size:"sm",onClick:G,children:(0,t.jsx)(r.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)(o.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-gray-800 mb-2",children:"บริจาคสิ่งของให้"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:y.title})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"สิ่งของที่ต้องการ"}),(0,t.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm text-blue-800",children:y.itemsNeeded}),(0,t.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"\uD83D\uDCA1 คุณสามารถนำสิ่งของที่ต้องการมาบริจาคได้เลย ไม่จำเป็นต้องระบุรายละเอียดในเว็บ"})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"วิธีการส่งมอบ"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("button",{className:"w-full p-4 border rounded-lg text-left transition-all ".concat("send-to-address"===k?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>C("send-to-address"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(n.Z,{className:"w-6 h-6 text-blue-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"ส่งตามที่อยู่"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"คุณส่งสิ่งของผ่านบริษัทขนส่งไปยังที่อยู่ผู้รับ"})]})]})}),(0,t.jsx)("button",{className:"w-full p-4 border rounded-lg text-left transition-all ".concat("drop-off"===k?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"),onClick:()=>C("drop-off"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(i.Z,{className:"w-6 h-6 text-green-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"นำไปส่งถึงที่"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"คุณนำสิ่งของไปส่งมอบด้วยตัวเองที่จุดรับบริจาค"})]})]})})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"กำหนดการส่งมอบ"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"deliveryDate",children:"วันที่ *"}),(0,t.jsx)(m.I,{id:"deliveryDate",type:"date",value:S,onChange:e=>D(e.target.value),min:new Date().toISOString().split("T")[0],required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"deliveryTime",children:"เวลา *"}),(0,t.jsxs)(u.Ph,{value:I,onValueChange:P,children:[(0,t.jsx)(u.i4,{children:(0,t.jsx)(u.ki,{placeholder:"เลือกเวลา"})}),(0,t.jsxs)(u.Bw,{children:[(0,t.jsx)(u.Ql,{value:"morning",children:"เช้า (09:00-12:00)"}),(0,t.jsx)(u.Ql,{value:"afternoon",children:"บ่าย (13:00-17:00)"}),(0,t.jsx)(u.Ql,{value:"evening",children:"เย็น (17:00-20:00)"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg",children:[(0,t.jsx)("h5",{className:"font-medium text-green-800 mb-2",children:"ที่อยู่สำหรับส่งของ"}),(0,t.jsxs)("div",{className:"text-sm text-green-700",children:[(0,t.jsx)("p",{className:"font-medium",children:y.address}),(0,t.jsxs)("p",{children:["โทร: ",y.contactPhone]})]})]}),"send-to-address"===k&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"trackingNumber",children:"เลขพัสดุ/รหัสอ้างอิง (หลังจากส่งแล้ว)"}),(0,t.jsx)(m.I,{id:"trackingNumber",placeholder:"เช่น TH1234567890 หรือรหัสอ้างอิงจากบริษัทขนส่ง",value:M,onChange:e=>V(e.target.value)}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"กรุณาระบุเลขพัสดุหลังจากส่งของแล้ว เพื่อให้ผู้รับสามารถติดตามได้"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"message",children:"ข้อความเพิ่มเติม"}),(0,t.jsx)(h.g,{id:"message",placeholder:"ข้อความให้กำลังใจหรือรายละเอียดเพิ่มเติม...",rows:3,value:R,onChange:e=>A(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"ข้อมูลผู้บริจาค"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.X,{id:"anonymous",checked:q,onCheckedChange:e=>{Q(!0===e)}}),(0,t.jsx)(x._,{htmlFor:"anonymous",className:"text-sm",children:"บริจาคแบบไม่ระบุชื่อ"})]}),!q&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"donorName",children:"ชื่อ-นามสกุล *"}),(0,t.jsx)(m.I,{id:"donorName",placeholder:"ระบุชื่อ-นามสกุล",value:F,onChange:e=>_(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"donorPhone",children:"เบอร์โทร *"}),(0,t.jsx)(m.I,{id:"donorPhone",type:"tel",placeholder:"081-234-5678",value:E,onChange:e=>T(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"donorEmail",children:"อีเมล"}),(0,t.jsx)(m.I,{id:"donorEmail",type:"email",placeholder:"example@email.com",value:O,onChange:e=>z(e.target.value)})]})]})]})]})]}),(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("h5",{className:"font-medium text-gray-800 mb-2",children:"สรุปการบริจาค"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"วิธีส่งมอบ:"}),(0,t.jsx)("span",{children:$(k)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"วันที่:"}),(0,t.jsx)("span",{children:S||"ไม่ระบุ"})]})]})]}),(0,t.jsx)(d.z,{className:"w-full bg-gradient-to-r from-blue-500 to-green-500 hover:from-blue-600 hover:to-green-600",onClick:B,disabled:Z||!S||!I||!q&&(!F||!E),children:Z?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"กำลังส่งข้อมูล..."]}):"ยืนยันการบริจาค"})]}),"success"===b&&(0,t.jsxs)("div",{className:"space-y-4 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:(0,t.jsx)(c.Z,{className:"w-8 h-8 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"บริจาคสำเร็จ!"}),(0,t.jsx)("p",{className:"text-gray-600",children:"ขอบคุณสำหรับความใจดีของคุณ"})]}),J>0&&(0,t.jsxs)("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"\uD83E\uDE99"}),(0,t.jsxs)("span",{className:"text-xl font-bold text-yellow-700",children:["+",J," คะแนน!"]})]}),(0,t.jsx)("p",{className:"text-sm text-yellow-600",children:"คุณได้รับคะแนนจากการบริจาคสิ่งของ สามารถนำไปแลกรางวัลได้"})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg space-y-2 text-left",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"วิธีส่งมอบ:"}),(0,t.jsx)("span",{className:"text-sm",children:$(k)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"วันที่นัดหมาย:"}),(0,t.jsx)("span",{className:"text-sm",children:S})]}),J>0&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"คะแนนที่ได้รับ:"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-yellow-600",children:["+",J," คะแนน"]})]}),!q&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ผู้บริจาค:"}),(0,t.jsx)("span",{className:"text-sm",children:F})]}),"send-to-address"===k&&M&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"เลขพัสดุ:"}),(0,t.jsx)("span",{className:"text-sm font-mono",children:M})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.z,{className:"w-full bg-gradient-to-r from-blue-500 to-green-500 hover:from-blue-600 hover:to-green-600",onClick:G,children:"เสร็จสิ้น"}),J>0&&(0,t.jsx)(d.z,{variant:"outline",className:"w-full bg-transparent",onClick:()=>{G(),U.push("/rewards")},children:"\uD83C\uDF81 ไปดูรางวัลที่แลกได้"}),(0,t.jsx)(d.z,{variant:"outline",className:"w-full bg-transparent",children:"แชร์การบริจาค"})]}),(0,t.jsx)("div",{className:"bg-blue-50 p-3 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDCDE ทีมงานจะติดต่อกลับภายใน 24 ชั่วโมง",(0,t.jsx)("br",{}),"\uD83D\uDCE7 คุณจะได้รับอีเมลยืนยันการบริจาคในอีกสักครู่"]})})]})]})]})}):null}},6831:function(e,s,a){a.d(s,{F$:function(){return c},Q5:function(){return d},qE:function(){return i}});var t=a(7437),l=a(2265),r=a(4930),n=a(4508);let i=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.fC,{ref:s,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...l})});i.displayName=r.fC.displayName;let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.Ee,{ref:s,className:(0,n.cn)("aspect-square h-full w-full",a),...l})});c.displayName=r.Ee.displayName;let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.NY,{ref:s,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...l})});d.displayName=r.NY.displayName},1800:function(e,s,a){a.d(s,{X:function(){return c}});var t=a(7437),l=a(2265),r=a(9270),n=a(401),i=a(4508);let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.fC,{ref:s,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...l,children:(0,t.jsx)(r.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})})});c.displayName=r.fC.displayName},6815:function(e,s,a){a.d(s,{_:function(){return d}});var t=a(7437),l=a(2265),r=a(6394),n=a(535),i=a(4508);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.f,{ref:s,className:(0,i.cn)(c(),a),...l})});d.displayName=r.f.displayName},2339:function(e,s,a){a.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return i},nU:function(){return o}});var t=a(7437),l=a(2265),r=a(1312),n=a(4508);let i=r.fC,c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.aV,{ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...l})});c.displayName=r.aV.displayName;let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.xz,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...l})});d.displayName=r.xz.displayName;let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.VY,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...l})});o.displayName=r.VY.displayName},6818:function(e,s,a){a.d(s,{g:function(){return n}});var t=a(7437),l=a(2265),r=a(4508);let n=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});n.displayName="Textarea"},6274:function(e,s,a){a.d(s,{Z:function(){return y}});var t=a(7437),l=a(2265),r=a(2660),n=a(2489),i=a(401),c=a(1047),d=a(2869),o=a(6070),m=a(5186),x=a(6815),h=a(6818),u=a(3647),p=a(1800),j=a(6973),g=a(4738),N=a(7992),f=a(9376);let v=[{id:"physical",name:"งานใช้แรงงาน",icon:"\uD83D\uDCAA",description:"ยกของหนัก ขนย้าย ทำความสะอาด"},{id:"professional",name:"งานเฉพาะทาง",icon:"\uD83D\uDC68‍\uD83D\uDCBC",description:"ช่างไฟฟ้า ช่างประปา ช่างก่อสร้าง"},{id:"creative",name:"งานสร้างสรรค์",icon:"\uD83C\uDFA8",description:"ถ่ายภาพ วีดีโอ ออกแบบ"},{id:"coordination",name:"งานประสานงาน",icon:"\uD83D\uDCCB",description:"จัดการ ประสานงาน บันทึกข้อมูล"},{id:"cooking",name:"งานครัว",icon:"\uD83D\uDC68‍\uD83C\uDF73",description:"ทำอาหาร เตรียมอาหาร แจกอาหาร"},{id:"transport",name:"งานขนส่ง",icon:"\uD83D\uDE97",description:"ขับรถ ส่งของ รับส่งคน"}];function y(e){let{isOpen:s,onClose:a,donation:y}=e,[b,w]=(0,l.useState)("personal"),[k,C]=(0,l.useState)(""),[S,D]=(0,l.useState)(""),[I,P]=(0,l.useState)(""),[F,_]=(0,l.useState)(""),[E,T]=(0,l.useState)(""),[O,z]=(0,l.useState)(""),[R,A]=(0,l.useState)(""),[q,Q]=(0,l.useState)(!1),[Z,L]=(0,l.useState)(""),[M,V]=(0,l.useState)([]),[J,H]=(0,l.useState)(""),[U,Y]=(0,l.useState)([]),[B,X]=(0,l.useState)(""),[G,$]=(0,l.useState)(""),[K,W]=(0,l.useState)(""),[ee,es]=(0,l.useState)(!1),[ea,et]=(0,l.useState)(0),el=(0,f.useRouter)(),{user:er}=(0,g.a)(),en=e=>{V(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},ei=e=>{Y(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},ec=async()=>{if(es(!0),await new Promise(e=>setTimeout(e,2e3)),er){let e="half-day"===G?4:"full-day"===G?8:"multiple-days"===G?16:8,s=j.g.calculateDonationPoints(e,"volunteer");j.g.addPoints(er.id,"volunteer",s,"Volunteer application for ".concat(y.title),y.id.toString()),et(s);let a={id:"volunteer_".concat(Date.now()),userId:er.id,requestId:y.id.toString(),requestTitle:y.title,type:"volunteer",date:new Date().toISOString(),status:"pending",skills:M,availableDates:U,preferredTime:B,duration:G,pointsEarned:s},t=JSON.parse(localStorage.getItem("user_volunteers_".concat(er.id))||"[]");t.push(a),localStorage.setItem("user_volunteers_".concat(er.id),JSON.stringify(t)),(0,N.Am)({title:"ได้รับ ".concat(s," คะแนน!"),description:"คุณได้รับคะแนนจากการสมัครเป็นอาสาสมัคร"})}es(!1),w("success")},ed=()=>{w("personal"),C(""),D(""),P(""),_(""),T(""),z(""),A(""),Q(!1),L(""),V([]),H(""),Y([]),X(""),$(""),W(""),es(!1),et(0)},eo=()=>{ed(),a()},em=()=>M.map(e=>{var s;return null===(s=v.find(s=>s.id===e))||void 0===s?void 0:s.name}).join(", "),ex=e=>({morning:"เช้า (09:00-12:00)",afternoon:"บ่าย (13:00-17:00)",evening:"เย็น (17:00-20:00)",flexible:"ยืดหยุ่นได้"})[e]||e,eh=e=>({"half-day":"ครึ่งวัน (4 ชั่วโมง)","full-day":"เต็มวัน (8 ชั่วโมง)","multiple-days":"หลายวัน",flexible:"ยืดหยุ่นได้"})[e]||e;return s?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)(o.Zb,{className:"w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["personal"!==b&&"success"!==b&&(0,t.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>{"skills"===b?w("personal"):"schedule"===b&&w("skills")},children:(0,t.jsx)(r.Z,{className:"w-4 h-4"})}),(0,t.jsxs)(o.ll,{className:"text-lg",children:["personal"===b&&"ข้อมูลส่วนตัว","skills"===b&&"ทักษะและความสามารถ","schedule"===b&&"กำหนดการและเวลา","success"===b&&"สมัครสำเร็จ"]})]}),(0,t.jsx)(d.z,{variant:"ghost",size:"sm",onClick:eo,children:(0,t.jsx)(n.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)(o.aY,{className:"space-y-4",children:["personal"===b&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-gray-800 mb-2",children:"สมัครอาสาสมัครสำหรับ"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:y.title})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"งานที่ต้องการอาสาสมัคร"}),(0,t.jsx)("div",{className:"p-3 bg-purple-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-purple-800",children:y.volunteerDescription})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"ข้อมูลส่วนตัว"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"volunteerName",children:"ชื่อ-นามสกุล *"}),(0,t.jsx)(m.I,{id:"volunteerName",placeholder:"ระบุชื่อ-นามสกุล",value:k,onChange:e=>C(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"volunteerPhone",children:"เบอร์โทร *"}),(0,t.jsx)(m.I,{id:"volunteerPhone",type:"tel",placeholder:"081-234-5678",value:S,onChange:e=>D(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"age",children:"อายุ *"}),(0,t.jsx)(m.I,{id:"age",type:"number",placeholder:"25",min:"18",max:"70",value:F,onChange:e=>_(e.target.value),required:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"volunteerEmail",children:"อีเมล"}),(0,t.jsx)(m.I,{id:"volunteerEmail",type:"email",placeholder:"example@email.com",value:I,onChange:e=>P(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"experience",children:"ประสบการณ์อาสาสมัคร"}),(0,t.jsxs)(u.Ph,{value:E,onValueChange:T,children:[(0,t.jsx)(u.i4,{children:(0,t.jsx)(u.ki,{placeholder:"เลือกประสบการณ์"})}),(0,t.jsxs)(u.Bw,{children:[(0,t.jsx)(u.Ql,{value:"none",children:"ไม่มีประสบการณ์"}),(0,t.jsx)(u.Ql,{value:"some",children:"มีประสบการณ์บ้าง"}),(0,t.jsx)(u.Ql,{value:"experienced",children:"มีประสบการณ์มาก"}),(0,t.jsx)(u.Ql,{value:"expert",children:"เชี่ยวชาญ"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"ข้อมูลติดต่อฉุกเฉิน"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"emergencyContact",children:"ชื่อผู้ติดต่อ *"}),(0,t.jsx)(m.I,{id:"emergencyContact",placeholder:"ชื่อญาติหรือเพื่อน",value:O,onChange:e=>z(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"emergencyPhone",children:"เบอร์โทร *"}),(0,t.jsx)(m.I,{id:"emergencyPhone",type:"tel",placeholder:"081-234-5678",value:R,onChange:e=>A(e.target.value),required:!0})]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"พาหนะส่วนตัว"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.X,{id:"hasVehicle",checked:q,onCheckedChange:e=>{Q(!0===e)}}),(0,t.jsx)(x._,{htmlFor:"hasVehicle",className:"text-sm",children:"มีพาหนะส่วนตัว"})]}),q&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"vehicleType",children:"ประเภทพาหนะ"}),(0,t.jsxs)(u.Ph,{value:Z,onValueChange:L,children:[(0,t.jsx)(u.i4,{children:(0,t.jsx)(u.ki,{placeholder:"เลือกประเภทพาหนะ"})}),(0,t.jsxs)(u.Bw,{children:[(0,t.jsx)(u.Ql,{value:"motorcycle",children:"รถจักรยานยนต์"}),(0,t.jsx)(u.Ql,{value:"car",children:"รถยนต์"}),(0,t.jsx)(u.Ql,{value:"pickup",children:"รถกระบะ"}),(0,t.jsx)(u.Ql,{value:"van",children:"รถตู้"})]})]})]})]}),(0,t.jsx)(d.z,{className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",onClick:()=>w("skills"),disabled:!k||!S||!F||!O||!R,children:"ถัดไป"})]}),"skills"===b&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"ทักษะและความสามารถ"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"เลือกทักษะที่คุณสามารถช่วยได้ (เลือกได้หลายข้อ)"}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-2",children:v.map(e=>(0,t.jsx)("button",{className:"p-3 border rounded-lg text-left transition-all ".concat(M.includes(e.id)?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"),onClick:()=>en(e.id),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-lg",children:e.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium text-sm",children:e.name}),M.includes(e.id)&&(0,t.jsx)(i.Z,{className:"w-4 h-4 text-purple-600"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:e.description})]})]})},e.id))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"skillDetails",children:"รายละเอียดทักษะเพิ่มเติม"}),(0,t.jsx)(h.g,{id:"skillDetails",placeholder:"เช่น มีประสบการณ์ช่างไฟฟ้า 5 ปี, เคยเป็นอาสาสมัครช่วยเหลือผู้ประสบภัย...",rows:4,value:J,onChange:e=>H(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x._,{htmlFor:"message",children:"ข้อความเพิ่มเติม"}),(0,t.jsx)(h.g,{id:"message",placeholder:"ข้อความให้กำลังใจหรือสิ่งที่อยากบอกผู้จัดการ...",rows:3,value:K,onChange:e=>W(e.target.value)})]}),(0,t.jsxs)(d.z,{className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",onClick:()=>w("schedule"),disabled:0===M.length,children:["ถัดไป (",M.length," ทักษะ)"]})]}),"schedule"===b&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"วันที่สะดวก"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"เลือกวันที่คุณสะดวกจะมาช่วย (เลือกได้หลายวัน)"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:(e=>{let s=[],a=new Date;for(let t=1;t<=e;t++){let e=new Date(a);e.setDate(a.getDate()+t),s.push({value:e.toISOString().split("T")[0],label:e.toLocaleDateString("th-TH",{weekday:"short",month:"short",day:"numeric"})})}return s})(14).map(e=>(0,t.jsx)("button",{className:"p-3 border rounded-lg text-center transition-all ".concat(U.includes(e.value)?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"),onClick:()=>ei(e.value),children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(c.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.label}),U.includes(e.value)&&(0,t.jsx)(i.Z,{className:"w-4 h-4 text-purple-600"})]})},e.value))})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"ช่วงเวลาที่สะดวก"}),(0,t.jsxs)(u.Ph,{value:B,onValueChange:X,children:[(0,t.jsx)(u.i4,{children:(0,t.jsx)(u.ki,{placeholder:"เลือกช่วงเวลา"})}),(0,t.jsxs)(u.Bw,{children:[(0,t.jsx)(u.Ql,{value:"morning",children:"เช้า (09:00-12:00)"}),(0,t.jsx)(u.Ql,{value:"afternoon",children:"บ่าย (13:00-17:00)"}),(0,t.jsx)(u.Ql,{value:"evening",children:"เย็น (17:00-20:00)"}),(0,t.jsx)(u.Ql,{value:"flexible",children:"ยืดหยุ่นได้"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800",children:"ระยะเวลาที่สามารถช่วยได้"}),(0,t.jsxs)(u.Ph,{value:G,onValueChange:$,children:[(0,t.jsx)(u.i4,{children:(0,t.jsx)(u.ki,{placeholder:"เลือกระยะเวลา"})}),(0,t.jsxs)(u.Bw,{children:[(0,t.jsx)(u.Ql,{value:"half-day",children:"ครึ่งวัน (4 ชั่วโมง)"}),(0,t.jsx)(u.Ql,{value:"full-day",children:"เต็มวัน (8 ชั่วโมง)"}),(0,t.jsx)(u.Ql,{value:"multiple-days",children:"หลายวัน"}),(0,t.jsx)(u.Ql,{value:"flexible",children:"ยืดหยุ่นได้"})]})]})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg space-y-2 text-left",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ชื่อ:"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:k})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ทักษะ:"}),(0,t.jsx)("span",{className:"text-sm text-right",children:em()})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"วันที่สะดวก:"}),(0,t.jsxs)("span",{className:"text-sm",children:[U.length," วัน"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ช่วงเวลา:"}),(0,t.jsx)("span",{className:"text-sm",children:ex(B)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ระยะเวลา:"}),(0,t.jsx)("span",{className:"text-sm",children:eh(G)})]})]}),(0,t.jsx)(d.z,{className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",onClick:ec,disabled:ee||0===U.length||!B||!G,children:ee?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"กำลังส่งข้อมูล..."]}):"ยืนยันการสมัคร"})]}),"success"===b&&(0,t.jsxs)("div",{className:"space-y-4 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:(0,t.jsx)(i.Z,{className:"w-8 h-8 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"สมัครสำเร็จ!"}),(0,t.jsx)("p",{className:"text-gray-600",children:"ขอบคุณที่เป็นอาสาสมัคร"})]}),ea>0&&(0,t.jsxs)("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"\uD83E\uDE99"}),(0,t.jsxs)("span",{className:"text-xl font-bold text-yellow-700",children:["+",ea," คะแนน!"]})]}),(0,t.jsx)("p",{className:"text-sm text-yellow-600",children:"คุณได้รับคะแนนจากการสมัครเป็นอาสาสมัคร สามารถนำไปแลกรางวัลได้"})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg space-y-2 text-left",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ชื่อ:"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:k})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ทักษะ:"}),(0,t.jsx)("span",{className:"text-sm text-right",children:em()})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"วันที่สะดวก:"}),(0,t.jsxs)("span",{className:"text-sm",children:[U.length," วัน"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ช่วงเวลา:"}),(0,t.jsx)("span",{className:"text-sm",children:ex(B)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"ระยะเวลา:"}),(0,t.jsx)("span",{className:"text-sm",children:eh(G)})]}),ea>0&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"คะแนนที่ได้รับ:"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-yellow-600",children:["+",ea," คะแนน"]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.z,{className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",onClick:eo,children:"เสร็จสิ้น"}),ea>0&&(0,t.jsx)(d.z,{variant:"outline",className:"w-full bg-transparent",onClick:()=>{eo(),el.push("/rewards")},children:"\uD83C\uDF81 ไปดูรางวัลที่แลกได้"}),(0,t.jsx)(d.z,{variant:"outline",className:"w-full bg-transparent",children:"แชร์การเป็นอาสาสมัคร"})]}),(0,t.jsx)("div",{className:"bg-purple-50 p-3 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-purple-800",children:["\uD83D\uDCDE ทีมงานจะติดต่อกลับภายใน 24 ชั่วโมง",(0,t.jsx)("br",{}),"\uD83D\uDCE7 คุณจะได้รับอีเมลยืนยันการสมัครในอีกสักครู่",(0,t.jsx)("br",{}),"\uD83D\uDCC5 รอการนัดหมายวันเวลาที่เหมาะสม"]})})]})]})]})}):null}},6973:function(e,s,a){a.d(s,{g:function(){return n}});var t=a(4147),l=a(4009);class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}calculateDonationPoints(e,s){switch(s){case"money":return Math.floor(e/100)*l.M.MONEY_DONATION;case"item":return l.M.ITEM_DONATION;case"volunteer":return e*l.M.VOLUNTEER_HOURS;default:return 0}}getUserLevel(e){let s=l.F.slice().reverse().find(s=>e>=s.minPoints)||l.F[0],a=l.F.find(s=>s.minPoints>e);return{...s,nextLevelPoints:a?a.minPoints:s.minPoints,progress:a?(e-s.minPoints)/(a.minPoints-s.minPoints)*100:100}}async addPoints(e,s,a,l,r){try{let n=await this.getUserPoints(e),i={id:(0,t.Z)(),type:"earned",amount:50,source:s,description:l,date:new Date().toISOString(),relatedId:r},c=await fetch("/api/points/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,type:i.type,amount:a,source:s,description:l,relatedId:r,transactionId:i.id})});if(!c.ok)throw Error("Failed to add points: ".concat(c.statusText));let{totalPoints:d,availablePoints:o,newReward:m}=await c.json(),x=this.getUserLevel(d),h={...n,totalPoints:d,availablePoints:o,level:x.level,levelName:x.name,nextLevelPoints:x.nextLevelPoints,progress:x.progress,color:x.color,pointsHistory:[i,...n.pointsHistory]};return this.userPoints.set(e,h),await this.saveToStorage(),h}catch(e){throw console.error("Error adding points:",e),e}}async spendPoints(e,s,a,l,r){try{let n=await this.getUserPoints(e);if(n.availablePoints<s)return!1;let i={id:(0,t.Z)(),type:"spent",amount:s,source:a,description:l,date:new Date().toISOString(),relatedId:r},c=await fetch("/api/points/spend",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,type:i.type,amount:s,source:a,description:l,relatedId:r,transactionId:i.id})});if(!c.ok)throw Error("Failed to spend points: ".concat(c.statusText));let d={...n,availablePoints:n.availablePoints-s,pointsHistory:[i,...n.pointsHistory]};return this.userPoints.set(e,d),await this.saveToStorage(),!0}catch(e){throw console.error("Error spending points:",e),e}}async getUserPoints(e,s){try{if(await this.loadFromStorage(),!this.userPoints.has(e)){let a="/api/points/".concat(e);console.log("Fetching points for userId: ".concat(e," from ").concat(a));let t=await fetch(a,{method:"GET",headers:{...s&&{Authorization:"Bearer ".concat(s)}}});if(console.log("API Response Status:",t.status,t.statusText),!t.ok)throw Error("Failed to fetch user points: ".concat(t.statusText," (").concat(t.status,")"));let l=await t.json();console.log("API Response Data:",l);let r=l.map(e=>{var s,a;return["earned","spent"].includes(e.type)?{id:e.id,type:e.type,amount:e.amount,source:e.source,description:e.description,date:e.date,relatedId:null!==(a=e.relatedId)&&void 0!==a?a:void 0}:(console.warn("Invalid transaction type: ".concat(e.type,', defaulting to "earned"')),{id:e.id,type:"earned",amount:e.amount,source:e.source,description:e.description,date:e.date,relatedId:null!==(s=e.relatedId)&&void 0!==s?s:void 0})}),n=r.filter(e=>"earned"===e.type).reduce((e,s)=>e+s.amount,0),i=r.reduce((e,s)=>"earned"===s.type?e+s.amount:e-s.amount,0),c=this.getUserLevel(n),d={userId:e,totalPoints:n,availablePoints:i,pointsHistory:r,level:c.level,levelName:c.name,nextLevelPoints:c.nextLevelPoints,progress:c.progress,color:c.color};this.userPoints.set(e,d)}return this.userPoints.get(e)}catch(e){throw console.error("Error fetching user points:",e),e}}async getUserRewards(e,s){try{let a="/api/rewards/".concat(e);console.log("Fetching rewards for userId: ".concat(e," from ").concat(a));let t=await fetch(a,{method:"GET",headers:{...s&&{Authorization:"Bearer ".concat(s)}}});if(console.log("API Response Status:",t.status,t.statusText),!t.ok)throw Error("Failed to fetch user rewards: ".concat(t.statusText," (").concat(t.status,")"));let l=await t.json();return console.log("API Response Data:",l),l}catch(e){throw console.error("Error fetching user rewards:",e),e}}async getLeaderboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{await this.loadFromStorage();let s=await fetch("/api/leaderboard?limit=".concat(e),{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to fetch leaderboard: ".concat(s.statusText));return(await s.json()).map(e=>{let s=e.pointsTransactions.map(e=>{var s,a;return["earned","spent"].includes(e.type)?{id:e.id,type:e.type,amount:e.amount,source:e.source,description:e.description,date:e.date,relatedId:null!==(a=e.relatedId)&&void 0!==a?a:void 0}:(console.warn("Invalid transaction type: ".concat(e.type,', defaulting to "earned"')),{id:e.id,type:"earned",amount:e.amount,source:e.source,description:e.description,date:e.date,relatedId:null!==(s=e.relatedId)&&void 0!==s?s:void 0})}),a=s.filter(e=>"earned"===e.type).reduce((e,s)=>e+s.amount,0),t=s.reduce((e,s)=>"earned"===s.type?e+s.amount:e-s.amount,0),l=this.getUserLevel(a);return{userId:e.id,totalPoints:a,availablePoints:t,pointsHistory:s,level:l.level,levelName:l.name,nextLevelPoints:l.nextLevelPoints,progress:l.progress,color:l.color}}).sort((e,s)=>s.totalPoints-e.totalPoints).slice(0,e)}catch(e){throw console.error("Error fetching leaderboard:",e),e}}async saveToStorage(){try{localStorage.setItem("userPoints",JSON.stringify(Array.from(this.userPoints.entries())))}catch(e){console.error("Failed to save to localStorage:",e)}}async loadFromStorage(){try{let e=localStorage.getItem("userPoints");if(e){let s=JSON.parse(e);this.userPoints=new Map(s)}}catch(e){console.error("Failed to load from localStorage:",e)}}constructor(){this.userPoints=new Map}}let n=r.getInstance()},4009:function(e,s,a){a.d(s,{F:function(){return l},M:function(){return t}});let t={MONEY_DONATION:10,ITEM_DONATION:50,VOLUNTEER_HOURS:20,STORY_SHARE:25,REFERRAL:100,DAILY_LOGIN:5,PROFILE_COMPLETE:50,ADD_AVATAR:30},l=[{level:1,name:"ผู้เริ่มต้น",minPoints:0,color:"#94a3b8"},{level:2,name:"ผู้ช่วยเหลือ",minPoints:100,color:"#10b981"},{level:3,name:"ผู้มีจิตใจดี",minPoints:500,color:"#3b82f6"},{level:4,name:"นักบุญแห่งการให้",minPoints:1e3,color:"#8b5cf6"},{level:5,name:"ทูตแห่งความดี",minPoints:2500,color:"#f59e0b"},{level:6,name:"ตำนานแห่งการบริจาค",minPoints:5e3,color:"#ef4444"}]}}]);